
> @dxheroes/ado-monorepo@0.1.0 test /Users/prokop/repos/_dxheroes/ado
> vitest run


[1m[46m RUN [49m[22m [36mv4.0.15 [39m[90m/Users/prokop/repos/_dxheroes/ado[39m

 [31mâ¯[39m packages/core/src/autonomous/__tests__/escalation-engine.test.ts [2m([22m[2m30 tests[22m[2m | [22m[31m7 failed[39m[2m)[22m[32m 33[2mms[22m[39m
       [32mâœ“[39m should create with default config[32m 2[2mms[22m[39m
       [32mâœ“[39m should create with custom config[32m 0[2mms[22m[39m
       [32mâœ“[39m should create engine with factory function[32m 0[2mms[22m[39m
       [32mâœ“[39m should create with custom config[32m 1[2mms[22m[39m
       [32mâœ“[39m should escalate critical stuck tasks to human immediately[32m 1[2mms[22m[39m
       [32mâœ“[39m should not fast escalate critical tasks with low confidence[32m 1[2mms[22m[39m
       [32mâœ“[39m should respect criticalTaskFastEscalation config[32m 1[2mms[22m[39m
       [32mâœ“[39m should suggest retry when not stuck[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should suggest different approach after max retries[39m[32m 10[2mms[22m[39m
       [32mâœ“[39m should suggest different approach for identical errors[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should suggest partial completion after max approaches[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should suggest different approach for no progress[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should escalate to human when partial completion not allowed[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should suggest partial completion for epic tasks on timeout[32m 0[2mms[22m[39m
       [32mâœ“[39m should escalate to human for non-epic tasks on timeout[32m 0[2mms[22m[39m
       [32mâœ“[39m should try different approach first for oscillating[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should escalate to human after one failed approach for oscillating[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m should retry once for test failures[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should escalate to human after retry for test failures[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should record escalation decision[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle multiple tasks independently[32m 0[2mms[22m[39m
       [32mâœ“[39m should return empty array for unknown task[32m 0[2mms[22m[39m
       [32mâœ“[39m should return escalation history[32m 1[2mms[22m[39m
       [32mâœ“[39m should clear escalation history for task[32m 3[2mms[22m[39m
       [32mâœ“[39m should not affect other tasks[32m 1[2mms[22m[39m
       [32mâœ“[39m should provide actionable suggestions for retry[32m 2[2mms[22m[39m
       [32mâœ“[39m should provide alternative strategies for different approach[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should provide handoff guidance for partial completion[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should provide clear guidance for human intervention[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should provide relevant strategies based on stuck reason[32m 0[2mms[22m[39m
 [31mâ¯[39m packages/core/src/parallel/__tests__/merge-coordinator.test.ts [2m([22m[2m28 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 32[2mms[22m[39m
       [32mâœ“[39m should create coordinator with default config[32m 2[2mms[22m[39m
       [32mâœ“[39m should create coordinator with custom config[32m 0[2mms[22m[39m
       [32mâœ“[39m should use factory function[32m 0[2mms[22m[39m
       [32mâœ“[39m should merge changes with no conflicts[32m 3[2mms[22m[39m
       [32mâœ“[39m should detect conflicts in same file[32m 1[2mms[22m[39m
       [32mâœ“[39m should auto-resolve identical changes[32m 1[2mms[22m[39m
       [32mâœ“[39m should auto-resolve similar changes[32m 2[2mms[22m[39m
       [32mâœ“[39m should require manual review for high-risk files[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle superset changes[32m 0[2mms[22m[39m
       [32mâœ“[39m should update metrics after merge[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle multiple files with mixed conflicts[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle large conflicts requiring manual review[32m 0[2mms[22m[39m
       [32mâœ“[39m should return initial metrics[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate auto-resolution rate correctly[32m 0[2mms[22m[39m
       [32mâœ“[39m should track average conflicts per merge[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should track resolution time[39m[32m 8[2mms[22m[39m
       [32mâœ“[39m should reset all metrics to zero[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect security files[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should detect .env files[39m[32m 6[2mms[22m[39m
       [32mâœ“[39m should detect migration files[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow custom high-risk patterns[32m 0[2mms[22m[39m
       [32mâœ“[39m should perform structural merge when line counts differ[32m 0[2mms[22m[39m
       [32mâœ“[39m should skip AI resolution when disabled[32m 0[2mms[22m[39m
       [32mâœ“[39m should use custom semantic similarity threshold[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle empty worker changes[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle single worker[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle workers with no files[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle three-way conflicts[32m 1[2mms[22m[39m
[90mstderr[2m | packages/core/src/autonomous/__tests__/recovery-manager.test.ts[2m > [22m[2mRecoveryManager[2m > [22m[2mwithRetry[2m > [22m[2mshould respect max attempts
[22m[39mRetry 1/3 for test-op after 10ms

[90mstderr[2m | packages/core/src/autonomous/__tests__/recovery-manager.test.ts[2m > [22m[2mRecoveryManager[2m > [22m[2mwithRetry[2m > [22m[2mshould respect max attempts
[22m[39mRetry 2/3 for test-op after 20ms

[90mstderr[2m | packages/core/src/autonomous/__tests__/recovery-manager.test.ts[2m > [22m[2mRecoveryManager[2m > [22m[2mwithRetry[2m > [22m[2mshould use exponential backoff
[22m[39mRetry 1/3 for test-op after 100ms

 [31mâ¯[39m packages/api/src/routes/__tests__/health.test.ts [2m([22m[2m25 tests[22m[2m | [22m[31m5 failed[39m[2m)[22m[32m 133[2mms[22m[39m
[31m       [31mÃ—[31m should return status ok[39m[32m 62[2mms[22m[39m
[31m       [31mÃ—[31m should return valid timestamp[39m[32m 5[2mms[22m[39m
       [32mâœ“[39m should respond quickly[32m 7[2mms[22m[39m
       [32mâœ“[39m should return ready when database is accessible[32m 8[2mms[22m[39m
       [32mâœ“[39m should check database connectivity[32m 2[2mms[22m[39m
       [32mâœ“[39m should return not_ready when database is not accessible[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle async state store[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle async state store errors[32m 1[2mms[22m[39m
       [32mâœ“[39m should return not_configured when state store is missing[32m 4[2mms[22m[39m
       [32mâœ“[39m should include timestamp in response[32m 2[2mms[22m[39m
       [32mâœ“[39m should return system information[32m 1[2mms[22m[39m
       [32mâœ“[39m should return Node.js version[32m 3[2mms[22m[39m
       [32mâœ“[39m should return uptime as number[32m 6[2mms[22m[39m
       [32mâœ“[39m should return memory usage[32m 1[2mms[22m[39m
       [32mâœ“[39m should return version from environment or default[32m 3[2mms[22m[39m
       [32mâœ“[39m should return valid timestamp[32m 10[2mms[22m[39m
       [32mâœ“[39m should handle state store check errors gracefully[32m 1[2mms[22m[39m
       [32mâœ“[39m should not expose internal error details[32m 2[2mms[22m[39m
       [32mâœ“[39m should respond to liveness check within 50ms[32m 1[2mms[22m[39m
       [32mâœ“[39m should respond to info check within 100ms[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return JSON content type[39m[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m should return valid JSON for all endpoints[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should support liveness probe[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should support readiness probe[32m 1[2mms[22m[39m
       [32mâœ“[39m should fail readiness when not ready[32m 0[2mms[22m[39m
[90mstderr[2m | packages/core/src/autonomous/__tests__/recovery-manager.test.ts[2m > [22m[2mRecoveryManager[2m > [22m[2mwithRetry[2m > [22m[2mshould use exponential backoff
[22m[39mRetry 2/3 for test-op after 200ms

[90mstderr[2m | packages/core/src/autonomous/__tests__/recovery-manager.test.ts[2m > [22m[2mRecoveryManager[2m > [22m[2mwithRetry[2m > [22m[2mshould respect max delay
[22m[39mRetry 1/3 for test-op after 500ms

 [31mâ¯[39m packages/core/src/autonomous/__tests__/spec-generator.test.ts [2m([22m[2m29 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 124[2mms[22m[39m
       [32mâœ“[39m should create generator with factory function[32m 2[2mms[22m[39m
       [32mâœ“[39m should generate feature specification[32m 3[2mms[22m[39m
       [32mâœ“[39m should enrich spec with project context[32m 1[2mms[22m[39m
       [32mâœ“[39m should add related specs to metadata[32m 2[2mms[22m[39m
       [32mâœ“[39m should set status to review for complex features[32m 0[2mms[22m[39m
       [32mâœ“[39m should set status to review for epic features[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate bug fix specification[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate refactoring specification[32m 1[2mms[22m[39m
       [32mâœ“[39m should add test coverage emphasis for refactoring[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate ADR for complex features[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate ADR for epic features[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate ADR for refactoring[32m 0[2mms[22m[39m
       [32mâœ“[39m should not generate ADR for simple features[32m 0[2mms[22m[39m
       [32mâœ“[39m should require tech lead for complex tasks[32m 0[2mms[22m[39m
       [32mâœ“[39m should require security team for auth changes[32m 0[2mms[22m[39m
       [32mâœ“[39m should require security team for permission changes[32m 0[2mms[22m[39m
       [32mâœ“[39m should require architect for architectural changes[32m 0[2mms[22m[39m
       [32mâœ“[39m should require architect for migrations[32m 0[2mms[22m[39m
       [32mâœ“[39m should require product manager for critical features[32m 0[2mms[22m[39m
       [32mâœ“[39m should default to code-owner when no special reviewers needed[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should convert specification to markdown[39m[32m 93[2mms[22m[39m
       [32mâœ“[39m should include metadata in markdown[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should convert ADR to markdown[39m[32m 12[2mms[22m[39m
       [32mâœ“[39m should include alternatives in markdown[32m 1[2mms[22m[39m
       [32mâœ“[39m should pass validation when all principles addressed[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect violations for security-sensitive changes[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should check blocker constraints[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should use existing constitution if provided[32m 0[2mms[22m[39m
       [32mâœ“[39m should create default constitution if none provided[32m 0[2mms[22m[39m
 [31mâ¯[39m packages/core/src/autonomous/__tests__/recovery-manager.test.ts [2m([22m[2m39 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 895[2mms[22m[39m
       [32mâœ“[39m should create with default config[32m 2[2mms[22m[39m
       [32mâœ“[39m should create with custom retry config[32m 0[2mms[22m[39m
       [32mâœ“[39m should create manager with factory function[32m 0[2mms[22m[39m
       [32mâœ“[39m should create with custom config[32m 1[2mms[22m[39m
       [32mâœ“[39m should create recovery point with checkpoint[32m 3[2mms[22m[39m
       [32mâœ“[39m should create recovery point with metadata[32m 0[2mms[22m[39m
       [32mâœ“[39m should store multiple recovery points[32m 1[2mms[22m[39m
       [32mâœ“[39m should succeed on first attempt[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should retry on retryable error[39m[32m 10[2mms[22m[39m
       [32mâœ“[39m should respect max attempts[32m 42[2mms[22m[39m
       [32mâœ“[39m should not retry non-retryable errors[32m 0[2mms[22m[39m
       [33m[2mâœ“[22m[39m should use exponential backoff [33m 305[2mms[22m[39m
       [33m[2mâœ“[22m[39m should respect max delay [33m 505[2mms[22m[39m
       [32mâœ“[39m should rollback to previous recovery point[32m 5[2mms[22m[39m
       [32mâœ“[39m should rollback multiple steps[32m 2[2mms[22m[39m
       [32mâœ“[39m should fail when no recovery points exist[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle rollback to first point[32m 2[2mms[22m[39m
       [32mâœ“[39m should restore from specific checkpoint[32m 1[2mms[22m[39m
       [32mâœ“[39m should create new recovery point after restore[32m 1[2mms[22m[39m
       [32mâœ“[39m should fail for invalid checkpoint[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should suggest retry for retryable errors within limit[39m[32m 6[2mms[22m[39m
       [32mâœ“[39m should not suggest retry when max attempts reached[32m 0[2mms[22m[39m
       [32mâœ“[39m should suggest rollback for stuck errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should suggest restore for corrupted state[32m 0[2mms[22m[39m
       [32mâœ“[39m should suggest abort for fatal errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should execute retry strategy[32m 0[2mms[22m[39m
       [32mâœ“[39m should execute rollback strategy[32m 0[2mms[22m[39m
       [32mâœ“[39m should execute restore strategy[32m 0[2mms[22m[39m
       [32mâœ“[39m should execute abort strategy[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle restore when no checkpoint available[32m 0[2mms[22m[39m
       [32mâœ“[39m should return empty array for unknown task[32m 0[2mms[22m[39m
       [32mâœ“[39m should return all recovery points for task[32m 0[2mms[22m[39m
       [32mâœ“[39m should clear recovery points for task[32m 0[2mms[22m[39m
       [32mâœ“[39m should not affect other tasks[32m 0[2mms[22m[39m
       [32mâœ“[39m should update retry configuration[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should detect timeout in error message[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect rate limit in error message[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect network errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect temporary errors[32m 0[2mms[22m[39m
 [31mâ¯[39m packages/api/src/trpc/routers/__tests__/tasks.test.ts [2m([22m[2m36 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[33m 1066[2mms[22m[39m
       [32mâœ“[39m should create a task with minimal input[32m 9[2mms[22m[39m
       [32mâœ“[39m should create a task with all optional fields[32m 1[2mms[22m[39m
       [32mâœ“[39m should validate prompt is not empty[32m 3[2mms[22m[39m
       [32mâœ“[39m should validate taskType is valid[32m 2[2mms[22m[39m
       [32mâœ“[39m should validate maxCost is positive[32m 2[2mms[22m[39m
       [32mâœ“[39m should validate coverage is between 0 and 100[32m 2[2mms[22m[39m
       [32mâœ“[39m should get task by ID[32m 95[2mms[22m[39m
       [32mâœ“[39m should return task with all fields[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m should throw error when state store is not configured[39m[33m 542[2mms[22m[39m
       [32mâœ“[39m should work with telemetry disabled[32m 4[2mms[22m[39m
       [32mâœ“[39m should list tasks with default parameters[32m 7[2mms[22m[39m
       [32mâœ“[39m should filter by status[32m 0[2mms[22m[39m
       [32mâœ“[39m should filter by projectId[32m 0[2mms[22m[39m
       [32mâœ“[39m should filter by providerId[32m 1[2mms[22m[39m
       [32mâœ“[39m should filter by tags[32m 0[2mms[22m[39m
       [32mâœ“[39m should filter by date range[32m 2[2mms[22m[39m
       [32mâœ“[39m should paginate with limit and offset[32m 2[2mms[22m[39m
       [32mâœ“[39m should respect max limit of 100[32m 47[2mms[22m[39m
       [32mâœ“[39m should sort by orderBy and order[32m 4[2mms[22m[39m
       [32mâœ“[39m should use default limit of 20[32m 19[2mms[22m[39m
       [32mâœ“[39m should cancel a task[32m 23[2mms[22m[39m
       [32mâœ“[39m should return success message[32m 34[2mms[22m[39m
       [32mâœ“[39m should pause a task[32m 161[2mms[22m[39m
       [32mâœ“[39m should return checkpoint ID[32m 5[2mms[22m[39m
       [32mâœ“[39m should resume a task without checkpoint[32m 8[2mms[22m[39m
       [32mâœ“[39m should resume a task with checkpoint[32m 2[2mms[22m[39m
       [32mâœ“[39m should return success message[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should create subscription for task events[39m[32m 15[2mms[22m[39m
[31m       [31mÃ—[31m should emit task events[39m[32m 21[2mms[22m[39m
[31m       [31mÃ—[31m should emit events with correct structure[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should handle errors gracefully in create[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle missing telemetry gracefully[32m 2[2mms[22m[39m
       [32mâœ“[39m should validate datetime strings[32m 4[2mms[22m[39m
       [32mâœ“[39m should validate enum values[32m 4[2mms[22m[39m
       [32mâœ“[39m should validate numeric ranges[32m 2[2mms[22m[39m
       [32mâœ“[39m should validate required fields[32m 6[2mms[22m[39m
 [31mâ¯[39m packages/api/src/trpc/routers/__tests__/workers.test.ts [2m([22m[2m40 tests[22m[2m | [22m[31m10 failed[39m[2m)[22m[33m 437[2mms[22m[39m
       [32mâœ“[39m should register a worker with minimal fields[32m 32[2mms[22m[39m
[31m       [31mÃ—[31m should register a worker with metadata[39m[32m 32[2mms[22m[39m
[31m       [31mÃ—[31m should validate workerId is not empty[39m[32m 56[2mms[22m[39m
       [32mâœ“[39m should validate capabilities array[32m 4[2mms[22m[39m
       [32mâœ“[39m should validate resources[32m 3[2mms[22m[39m
       [32mâœ“[39m should send heartbeat for worker[32m 9[2mms[22m[39m
       [32mâœ“[39m should return current timestamp[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m should validate workerId[39m[32m 7[2mms[22m[39m
       [32mâœ“[39m should list all workers with default parameters[32m 3[2mms[22m[39m
       [32mâœ“[39m should filter by status[32m 4[2mms[22m[39m
       [32mâœ“[39m should filter by capability[32m 142[2mms[22m[39m
       [32mâœ“[39m should paginate with limit and offset[32m 6[2mms[22m[39m
       [32mâœ“[39m should respect max limit of 100[32m 3[2mms[22m[39m
       [32mâœ“[39m should use default limit of 20[32m 3[2mms[22m[39m
       [32mâœ“[39m should validate status enum[32m 3[2mms[22m[39m
       [32mâœ“[39m should get worker status[32m 3[2mms[22m[39m
       [32mâœ“[39m should return resources information[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should validate workerId[39m[32m 27[2mms[22m[39m
       [32mâœ“[39m should assign task to worker[32m 3[2mms[22m[39m
       [32mâœ“[39m should return assignment timestamp[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should validate workerId and taskId[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should unregister a worker[32m 1[2mms[22m[39m
       [32mâœ“[39m should return unregistration timestamp[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should validate workerId[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should create subscription for worker status[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should emit worker status events[39m[32m 14[2mms[22m[39m
[31m       [31mÃ—[31m should emit events with correct structure[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle errors gracefully in register[32m 5[2mms[22m[39m
       [32mâœ“[39m should handle missing telemetry gracefully[32m 9[2mms[22m[39m
       [32mâœ“[39m should handle errors in heartbeat[32m 9[2mms[22m[39m
       [32mâœ“[39m should validate enum values[32m 8[2mms[22m[39m
       [32mâœ“[39m should validate numeric ranges[32m 10[2mms[22m[39m
       [32mâœ“[39m should validate required fields[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should validate string fields are not empty[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should trace register calls[32m 3[2mms[22m[39m
       [32mâœ“[39m should trace heartbeat calls[32m 1[2mms[22m[39m
       [32mâœ“[39m should trace list calls[32m 1[2mms[22m[39m
       [32mâœ“[39m should trace getStatus calls[32m 0[2mms[22m[39m
       [32mâœ“[39m should trace assignTask calls[32m 0[2mms[22m[39m
       [32mâœ“[39m should trace unregister calls[32m 0[2mms[22m[39m
 [31mâ¯[39m packages/adapters/src/claude-code/__tests__/adapter.test.ts [2m([22m[2m27 tests[22m[2m | [22m[31m10 failed[39m[2m)[22m[32m 219[2mms[22m[39m
       [32mâœ“[39m should have correct id[32m 6[2mms[22m[39m
       [32mâœ“[39m should have correct capabilities[32m 2[2mms[22m[39m
       [32mâœ“[39m should initialize with config[32m 0[2mms[22m[39m
       [32mâœ“[39m should return true when claude CLI is available[32m 4[2mms[22m[39m
       [32mâœ“[39m should return false when claude CLI is not available[32m 1[2mms[22m[39m
       [32mâœ“[39m should return false when command exits with non-zero code[32m 0[2mms[22m[39m
       [32mâœ“[39m should timeout after 5 seconds[32m 8[2mms[22m[39m
       [32mâœ“[39m should emit start event[32m 13[2mms[22m[39m
[31m       [31mÃ—[31m should emit complete event on success[39m[32m 27[2mms[22m[39m
[31m       [31mÃ—[31m should emit error event on failure[39m[32m 16[2mms[22m[39m
[31m       [31mÃ—[31m should spawn claude with correct arguments[39m[32m 24[2mms[22m[39m
[31m       [31mÃ—[31m should support resume option[39m[32m 17[2mms[22m[39m
[31m       [31mÃ—[31m should support model option[39m[32m 18[2mms[22m[39m
[31m       [31mÃ—[31m should support maxTurns option[39m[32m 11[2mms[22m[39m
[31m       [31mÃ—[31m should support permissionMode option[39m[32m 12[2mms[22m[39m
[31m       [31mÃ—[31m should handle process errors[39m[32m 20[2mms[22m[39m
[31m       [31mÃ—[31m should mark SIGINT errors as recoverable[39m[32m 13[2mms[22m[39m
[31m       [31mÃ—[31m should kill the running process[39m[32m 15[2mms[22m[39m
       [32mâœ“[39m should handle interrupt when no process is running[32m 1[2mms[22m[39m
       [32mâœ“[39m should return ClaudeRateLimitDetector[32m 1[2mms[22m[39m
       [32mâœ“[39m should track usage[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect rate limit when limit is reached[32m 0[2mms[22m[39m
       [32mâœ“[39m should parse rate limit errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should return null for non-rate-limit errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should get remaining capacity[32m 0[2mms[22m[39m
       [32mâœ“[39m should return CLAUDE.md by default[32m 0[2mms[22m[39m
       [32mâœ“[39m should return custom context file from config[32m 0[2mms[22m[39m
 [31mâ¯[39m packages/core/src/autonomous/__tests__/pr-agent-integration.test.ts [2m([22m[2m37 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 123[2mms[22m[39m
       [32mâœ“[39m should create with default config[32m 2[2mms[22m[39m
       [32mâœ“[39m should create with custom config[32m 0[2mms[22m[39m
       [32mâœ“[39m should create agent with factory function[32m 0[2mms[22m[39m
       [32mâœ“[39m should create with custom config[32m 2[2mms[22m[39m
       [32mâœ“[39m should generate PR description from commits[32m 1[2mms[22m[39m
       [32mâœ“[39m should infer type from commit messages[32m 0[2mms[22m[39m
       [32mâœ“[39m should detect breaking changes[32m 0[2mms[22m[39m
       [32mâœ“[39m should extract related issues[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle empty commits[32m 1[2mms[22m[39m
       [32mâœ“[39m should review PR and generate score[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect security-sensitive files[32m 1[2mms[22m[39m
       [32mâœ“[39m should detect human review required patterns[32m 2[2mms[22m[39m
       [32mâœ“[39m should auto-approve high-quality PRs[32m 0[2mms[22m[39m
       [32mâœ“[39m should not auto-approve with errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should require human review for low scores[32m 0[2mms[22m[39m
       [32mâœ“[39m should estimate review time[32m 0[2mms[22m[39m
       [32mâœ“[39m should update metrics on review[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate improvement suggestions[32m 67[2mms[22m[39m
       [32mâœ“[39m should sort suggestions by impact/effort ratio[32m 0[2mms[22m[39m
       [32mâœ“[39m should include before/after code[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate changelog entry[32m 8[2mms[22m[39m
       [32mâœ“[39m should categorize changes by type[32m 8[2mms[22m[39m
[31m       [31mÃ—[31m should detect breaking changes in changelog[39m[32m 13[2mms[22m[39m
       [32mâœ“[39m should include date in ISO format[32m 0[2mms[22m[39m
       [32mâœ“[39m should learn from approved high-quality PRs[32m 0[2mms[22m[39m
       [32mâœ“[39m should not learn when learning mode disabled[32m 0[2mms[22m[39m
       [32mâœ“[39m should not learn from low-scoring PRs[32m 0[2mms[22m[39m
       [32mâœ“[39m should return PR agent metrics[32m 0[2mms[22m[39m
       [32mâœ“[39m should track auto-approval counts[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate average score[32m 0[2mms[22m[39m
       [32mâœ“[39m should return learned team standards[32m 0[2mms[22m[39m
       [32mâœ“[39m should organize standards by file extension[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should match security-sensitive file patterns[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should match human review required patterns[39m[32m 5[2mms[22m[39m
       [32mâœ“[39m should generate comments with various severities[32m 0[2mms[22m[39m
       [32mâœ“[39m should categorize comments[32m 1[2mms[22m[39m
       [32mâœ“[39m should deduct points based on severity[32m 0[2mms[22m[39m
 [31mâ¯[39m packages/core/src/parallel/__tests__/work-stealing-scheduler.test.ts [2m([22m[2m41 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 35[2mms[22m[39m
       [32mâœ“[39m should create scheduler with default config[32m 1[2mms[22m[39m
       [32mâœ“[39m should create scheduler with custom config[32m 0[2mms[22m[39m
       [32mâœ“[39m should use factory function[32m 0[2mms[22m[39m
       [32mâœ“[39m should initialize worker queues[32m 1[2mms[22m[39m
       [32mâœ“[39m should submit task to least loaded worker[32m 0[2mms[22m[39m
       [32mâœ“[39m should distribute tasks to least loaded workers[32m 0[2mms[22m[39m
       [32mâœ“[39m should throw if no workers available[32m 1[2mms[22m[39m
       [32mâœ“[39m should distribute tasks using round-robin[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle more tasks than workers[32m 4[2mms[22m[39m
       [32mâœ“[39m should handle empty task list[32m 1[2mms[22m[39m
       [32mâœ“[39m should return task from own queue[32m 0[2mms[22m[39m
       [32mâœ“[39m should mark worker as busy when getting task[32m 0[2mms[22m[39m
       [32mâœ“[39m should steal task when own queue is empty[32m 1[2mms[22m[39m
       [32mâœ“[39m should return undefined when no work available[32m 0[2mms[22m[39m
       [32mâœ“[39m should use FIFO for own queue[32m 0[2mms[22m[39m
       [32mâœ“[39m should use LIFO for stealing (from end of queue)[32m 0[2mms[22m[39m
       [32mâœ“[39m should throw for unknown worker[32m 0[2mms[22m[39m
       [32mâœ“[39m should mark task as completed[32m 0[2mms[22m[39m
       [32mâœ“[39m should only complete current task[32m 0[2mms[22m[39m
       [32mâœ“[39m should throw for unknown worker[32m 0[2mms[22m[39m
       [32mâœ“[39m should only steal when victim has enough tasks[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should respect max steal attempts[39m[32m 8[2mms[22m[39m
       [32mâœ“[39m should select most loaded worker for stealing when not random[32m 0[2mms[22m[39m
       [32mâœ“[39m should use random selection when enabled[32m 0[2mms[22m[39m
       [32mâœ“[39m should split large tasks when enabled[32m 0[2mms[22m[39m
       [32mâœ“[39m should not split small tasks[32m 0[2mms[22m[39m
       [32mâœ“[39m should not split non-splittable tasks[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should return scheduler metrics[39m[32m 8[2mms[22m[39m
       [32mâœ“[39m should track completed tasks[32m 0[2mms[22m[39m
       [32mâœ“[39m should track successful steals[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate average queue length[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate worker utilization[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate load balance score[32m 1[2mms[22m[39m
       [32mâœ“[39m should return worker queue by ID[32m 0[2mms[22m[39m
       [32mâœ“[39m should return undefined for unknown worker[32m 0[2mms[22m[39m
       [32mâœ“[39m should return all worker queues[32m 0[2mms[22m[39m
       [32mâœ“[39m should reset scheduler state[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle single worker[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle high task priority[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle tasks with estimated duration[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle concurrent task requests[32m 0[2mms[22m[39m
 [31mâ¯[39m packages/core/src/autonomous/__tests__/doc-first-workflow.test.ts [2m([22m[2m19 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 293[2mms[22m[39m
       [32mâœ“[39m should create workflow with factory function[32m 6[2mms[22m[39m
       [32mâœ“[39m should execute complete workflow phases[32m 5[2mms[22m[39m
       [32mâœ“[39m should track workflow phases[32m 6[2mms[22m[39m
       [32mâœ“[39m should fail when quality gates not passed[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle workflow errors gracefully[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should initialize state correctly[39m[32m 72[2mms[22m[39m
       [32mâœ“[39m should track validation reports[32m 15[2mms[22m[39m
       [32mâœ“[39m should create summary with task counts[32m 2[2mms[22m[39m
       [32mâœ“[39m should allow subscribing to workflow events[32m 25[2mms[22m[39m
       [32mâœ“[39m should emit events during workflow execution[32m 53[2mms[22m[39m
       [32mâœ“[39m should generate specification from prompt[32m 14[2mms[22m[39m
       [32mâœ“[39m should decompose task into subtasks[32m 9[2mms[22m[39m
       [32mâœ“[39m should execute tasks in stages[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should apply auto-fixes when validation fails[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m should perform final validation[32m 1[2mms[22m[39m
       [32mâœ“[39m should respect requireHumanApproval flag[32m 6[2mms[22m[39m
       [32mâœ“[39m should coordinate with HITL checkpoints[32m 36[2mms[22m[39m
       [32mâœ“[39m should handle stuck auto-fix gracefully[32m 5[2mms[22m[39m
       [32mâœ“[39m should handle no fixes available scenario[32m 6[2mms[22m[39m
 [31mâ¯[39m packages/core/src/autonomous/__tests__/typescript-validator.test.ts [2m([22m[2m26 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 379[2mms[22m[39m
       [32mâœ“[39m should create validator with correct properties[32m 15[2mms[22m[39m
       [32mâœ“[39m should create validator with factory function[32m 4[2mms[22m[39m
       [32mâœ“[39m should detect TypeScript in devDependencies[32m 2[2mms[22m[39m
       [32mâœ“[39m should detect TypeScript in dependencies[32m 2[2mms[22m[39m
       [32mâœ“[39m should not detect TypeScript when missing[32m 25[2mms[22m[39m
       [32mâœ“[39m should handle missing package.json[32m 63[2mms[22m[39m
       [32mâœ“[39m should run validators in parallel when enabled[32m 38[2mms[22m[39m
       [32mâœ“[39m should run validators sequentially when parallel disabled[32m 12[2mms[22m[39m
       [32mâœ“[39m should pass when no issues[32m 7[2mms[22m[39m
       [32mâœ“[39m should block on type errors when configured[32m 1[2mms[22m[39m
       [32mâœ“[39m should block on lint errors when configured[32m 1[2mms[22m[39m
       [32mâœ“[39m should block on test failures when configured[32m 64[2mms[22m[39m
       [32mâœ“[39m should block when coverage below minimum[32m 7[2mms[22m[39m
       [32mâœ“[39m should pass with sufficient coverage[32m 1[2mms[22m[39m
       [32mâœ“[39m should block when exceeding max errors[32m 1[2mms[22m[39m
       [32mâœ“[39m should warn about warnings when not allowed[32m 14[2mms[22m[39m
       [32mâœ“[39m should not block on warnings when allowed[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle multiple validation results[32m 1[2mms[22m[39m
       [32mâœ“[39m should accumulate blockers from multiple results[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should handle specific files[39m[32m 69[2mms[22m[39m
[31m       [31mÃ—[31m should use working directory[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should have correct language property[32m 0[2mms[22m[39m
       [32mâœ“[39m should list all validators[32m 1[2mms[22m[39m
       [32mâœ“[39m should respect blockOnTypeErrors setting[32m 8[2mms[22m[39m
       [32mâœ“[39m should respect blockOnLintErrors setting[32m 1[2mms[22m[39m
       [32mâœ“[39m should respect blockOnTestFailures setting[32m 1[2mms[22m[39m
 [31mâ¯[39m packages/core/src/parallel/__tests__/cost-aware-load-balancer.test.ts [2m([22m[2m40 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 193[2mms[22m[39m
       [32mâœ“[39m should create load balancer with default config[32m 4[2mms[22m[39m
       [32mâœ“[39m should create load balancer with custom config[32m 0[2mms[22m[39m
       [32mâœ“[39m should use factory function[32m 0[2mms[22m[39m
       [32mâœ“[39m should register worker with cost profile[32m 3[2mms[22m[39m
       [32mâœ“[39m should register multiple workers[32m 2[2mms[22m[39m
       [32mâœ“[39m should update worker profile[32m 0[2mms[22m[39m
       [32mâœ“[39m should throw for non-existent worker[32m 2[2mms[22m[39m
       [32mâœ“[39m should route task to available worker[32m 2[2mms[22m[39m
       [32mâœ“[39m should minimize cost with minimize-cost strategy[32m 2[2mms[22m[39m
       [32mâœ“[39m should maximize performance with maximize-performance strategy[32m 1[2mms[22m[39m
       [32mâœ“[39m should balance cost and performance with balanced strategy[32m 2[2mms[22m[39m
       [32mâœ“[39m should consider task complexity[32m 0[2mms[22m[39m
       [32mâœ“[39m should consider estimated duration[32m 2[2mms[22m[39m
       [32mâœ“[39m should avoid overloaded workers[32m 1[2mms[22m[39m
       [32mâœ“[39m should throw when no workers available[32m 1[2mms[22m[39m
       [32mâœ“[39m should throw when all workers are overloaded[32m 2[2mms[22m[39m
       [32mâœ“[39m should enforce max cost per task[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should enforce daily budget limit[39m[32m 22[2mms[22m[39m
       [32mâœ“[39m should use per-task cost if available[32m 0[2mms[22m[39m
       [32mâœ“[39m should match complexity to performance tier[32m 0[2mms[22m[39m
       [32mâœ“[39m should record routing history[32m 0[2mms[22m[39m
       [32mâœ“[39m should return initial metrics[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate total cost[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate average completion time[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate cost savings[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate budget utilization[32m 0[2mms[22m[39m
       [32mâœ“[39m should not include budget utilization without limit[32m 0[2mms[22m[39m
       [32mâœ“[39m should reset routing history[32m 0[2mms[22m[39m
       [32mâœ“[39m should return empty array initially[32m 0[2mms[22m[39m
       [32mâœ“[39m should return all registered workers[32m 12[2mms[22m[39m
       [32mâœ“[39m should prioritize cost over performance with cost weight[32m 1[2mms[22m[39m
       [32mâœ“[39m should prioritize performance over cost with performance weight[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle workers with zero cost[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle workers with same cost and performance[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle moderate complexity[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle very low utilization workers[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle tasks without duration estimate[32m 0[2mms[22m[39m
       [32mâœ“[39m should generate clear reasoning for routing decision[32m 0[2mms[22m[39m
       [32mâœ“[39m should include cost information in minimize-cost strategy[32m 39[2mms[22m[39m
       [32mâœ“[39m should include performance information in maximize-performance strategy[32m 4[2mms[22m[39m
 [31mâ¯[39m packages/api/src/trpc/__tests__/trpc.test.ts [2m([22m[2m26 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 117[2mms[22m[39m
       [32mâœ“[39m should create a router[32m 3[2mms[22m[39m
       [32mâœ“[39m should create router with multiple procedures[32m 3[2mms[22m[39m
       [32mâœ“[39m should create nested routers[32m 1[2mms[22m[39m
       [32mâœ“[39m should create a public query procedure[32m 2[2mms[22m[39m
       [32mâœ“[39m should create a public mutation procedure[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow accessing context in procedure[32m 1[2mms[22m[39m
       [32mâœ“[39m should create middleware[32m 0[2mms[22m[39m
       [32mâœ“[39m should create middleware that modifies context[32m 0[2mms[22m[39m
       [32mâœ“[39m should be defined[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should throw error when state store is not configured[39m[32m 91[2mms[22m[39m
[31m       [31mÃ—[31m should call next when state store is configured[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should pass state store in context to next[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should be defined[32m 0[2mms[22m[39m
       [32mâœ“[39m should create protected query procedure[32m 0[2mms[22m[39m
       [32mâœ“[39m should create protected mutation procedure[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle Date objects[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle undefined values[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle Map objects[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle Set objects[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle BigInt values[32m 0[2mms[22m[39m
       [32mâœ“[39m should format errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle async errors[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle errors in mutations[32m 0[2mms[22m[39m
       [32mâœ“[39m should compose multiple middlewares[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow chaining use and query[32m 0[2mms[22m[39m
       [32mâœ“[39m should allow chaining use and mutation[32m 0[2mms[22m[39m
 [31mâ¯[39m packages/core/src/state/__tests__/postgresql.test.ts [2m([22m[2m39 tests[22m[2m | [22m[33m39 skipped[39m[2m)[22m[33m 4066[2mms[22m[39m
       [2m[90mâ†“[39m[22m should create database schema on initialization
       [2m[90mâ†“[39m[22m should accept custom pool configuration
       [2m[90mâ†“[39m[22m should create a session
       [2m[90mâ†“[39m[22m should create session with metadata
       [2m[90mâ†“[39m[22m should get session by ID
       [2m[90mâ†“[39m[22m should return null for non-existent session
       [2m[90mâ†“[39m[22m should get sessions by project
       [2m[90mâ†“[39m[22m should update session
       [2m[90mâ†“[39m[22m should update session timestamp on update
       [2m[90mâ†“[39m[22m should handle empty update
       [2m[90mâ†“[39m[22m should create a task
       [2m[90mâ†“[39m[22m should create task with all fields
       [2m[90mâ†“[39m[22m should get task by ID
       [2m[90mâ†“[39m[22m should return null for non-existent task
       [2m[90mâ†“[39m[22m should update task status
       [2m[90mâ†“[39m[22m should update task with completion data
       [2m[90mâ†“[39m[22m should update task with error
       [2m[90mâ†“[39m[22m should get tasks by session
       [2m[90mâ†“[39m[22m should get tasks by status
       [2m[90mâ†“[39m[22m should handle empty task update
       [2m[90mâ†“[39m[22m should record usage
       [2m[90mâ†“[39m[22m should record usage with cost
       [2m[90mâ†“[39m[22m should get usage by provider
       [2m[90mâ†“[39m[22m should filter usage by timestamp
       [2m[90mâ†“[39m[22m should get total usage
       [2m[90mâ†“[39m[22m should return zero for total usage with no records
       [2m[90mâ†“[39m[22m should create a checkpoint
       [2m[90mâ†“[39m[22m should get checkpoint by ID
       [2m[90mâ†“[39m[22m should return null for non-existent checkpoint
       [2m[90mâ†“[39m[22m should get latest checkpoint for task
       [2m[90mâ†“[39m[22m should return null for latest checkpoint when no checkpoints exist
       [2m[90mâ†“[39m[22m should handle multiple checkpoints for different tasks
       [2m[90mâ†“[39m[22m should preserve complex metadata across session operations
       [2m[90mâ†“[39m[22m should preserve task definition across operations
       [2m[90mâ†“[39m[22m should handle cascading deletes for sessions
       [2m[90mâ†“[39m[22m should close database connection
       [2m[90mâ†“[39m[22m should handle multiple close calls
       [2m[90mâ†“[39m[22m should create PostgreSQL state store using factory
       [2m[90mâ†“[39m[22m should create store with custom config using factory
 [31mâ¯[39m packages/api/src/routes/__tests__/providers.test.ts [2m([22m[2m39 tests[22m[2m | [22m[31m23 failed[39m[2m)[22m[32m 182[2mms[22m[39m
[31m       [31mÃ—[31m should list all providers[39m[32m 18[2mms[22m[39m
[31m       [31mÃ—[31m should return provider configuration[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should include access modes[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should include capabilities[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should include usage data[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should fallback to default providers on config error[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should include rate limits when available[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should get provider by ID[32m 41[2mms[22m[39m
       [32mâœ“[39m should return provider details[32m 5[2mms[22m[39m
       [32mâœ“[39m should return 404 for non-existent provider[32m 9[2mms[22m[39m
       [32mâœ“[39m should include all capability flags[32m 6[2mms[22m[39m
       [32mâœ“[39m should include access mode configurations[32m 9[2mms[22m[39m
       [32mâœ“[39m should fallback to default providers[32m 8[2mms[22m[39m
       [32mâœ“[39m should return 501 not implemented[32m 1[2mms[22m[39m
       [32mâœ“[39m should return helpful error message[32m 0[2mms[22m[39m
       [32mâœ“[39m should return provider usage[32m 2[2mms[22m[39m
       [32mâœ“[39m should include usage statistics[32m 2[2mms[22m[39m
       [32mâœ“[39m should include rate limits[32m 7[2mms[22m[39m
       [32mâœ“[39m should calculate remaining capacity[32m 2[2mms[22m[39m
       [32mâœ“[39m should return 404 for non-existent provider[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should handle provider without rate limits[39m[32m 10[2mms[22m[39m
       [32mâœ“[39m should calculate remaining requests correctly[32m 5[2mms[22m[39m
       [32mâœ“[39m should fallback to default providers[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should include subscription providers[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should include API providers[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should include free providers[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should include both enabled and disabled providers[39m[32m 11[2mms[22m[39m
[31m       [31mÃ—[31m should mark codex-cli as disabled by default[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m should return JSON content type[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should return valid JSON for all endpoints[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle config loading errors gracefully[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle state store errors in usage tracking[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should fetch usage from state store[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should aggregate multiple usage records[39m[32m 0[2mms[22m[39m
       [32mâœ“[39m should include claude-code[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m should include gemini-cli[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should include cursor-cli[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should include copilot-cli[39m[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should include codex-cli[39m[32m 3[2mms[22m[39m
 [31mâ¯[39m packages/core/src/streaming/__tests__/progress-stream.test.ts [2m([22m[2m63 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 10398[2mms[22m[39m
       [32mâœ“[39m should emit task_queued event[32m 12[2mms[22m[39m
       [32mâœ“[39m should emit task_started event[32m 1[2mms[22m[39m
       [32mâœ“[39m should emit task_progress event[32m 0[2mms[22m[39m
       [32mâœ“[39m should emit task_output event and append content[32m 0[2mms[22m[39m
       [32mâœ“[39m should emit task_paused event[32m 0[2mms[22m[39m
       [32mâœ“[39m should emit task_resumed event[32m 0[2mms[22m[39m
       [32mâœ“[39m should emit task_completed event[32m 0[2mms[22m[39m
       [32mâœ“[39m should emit task_failed event[32m 0[2mms[22m[39m
       [32mâœ“[39m should emit task_cancelled event[32m 1[2mms[22m[39m
       [32mâœ“[39m should buffer events for subscribers[32m 0[2mms[22m[39m
       [32mâœ“[39m should notify subscribers when event is emitted[32m 9[2mms[22m[39m
       [32mâœ“[39m should handle subscriber errors gracefully[32m 12[2mms[22m[39m
       [32mâœ“[39m should schedule buffer cleanup after completion[32m 14[2mms[22m[39m
       [32mâœ“[39m should schedule buffer cleanup after failure[32m 6[2mms[22m[39m
       [32mâœ“[39m should schedule buffer cleanup after cancellation[32m 1[2mms[22m[39m
       [32mâœ“[39m should yield buffered events first[32m 0[2mms[22m[39m
       [32mâœ“[39m should subscribe to new events after buffered events[32m 1[2mms[22m[39m
       [32mâœ“[39m should unsubscribe on completion[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle multiple subscribers for same task[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle late subscriber getting buffered events[32m 2[2mms[22m[39m
       [32mâœ“[39m should return immediately for completed task[32m 0[2mms[22m[39m
       [32mâœ“[39m should return immediately for failed task[32m 2[2mms[22m[39m
       [32mâœ“[39m should return immediately for cancelled task[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should cleanup subscriber on iterator return[39m[33m 10310[2mms[22m[39m
       [32mâœ“[39m should return current task status[32m 0[2mms[22m[39m
       [32mâœ“[39m should return undefined for unknown task[32m 0[2mms[22m[39m
       [32mâœ“[39m should reflect latest status updates[32m 0[2mms[22m[39m
       [32mâœ“[39m should return all task statuses[32m 2[2mms[22m[39m
       [32mâœ“[39m should return empty array when no tasks[32m 0[2mms[22m[39m
       [32mâœ“[39m should update status to queued on task_queued[32m 0[2mms[22m[39m
       [32mâœ“[39m should update status to running on task_started[32m 0[2mms[22m[39m
       [32mâœ“[39m should update progress on task_progress[32m 0[2mms[22m[39m
       [32mâœ“[39m should append output on task_output[32m 0[2mms[22m[39m
       [32mâœ“[39m should update status to paused on task_paused[32m 0[2mms[22m[39m
       [32mâœ“[39m should update status to running on task_resumed[32m 0[2mms[22m[39m
       [32mâœ“[39m should update status to completed on task_completed[32m 2[2mms[22m[39m
       [32mâœ“[39m should update status to failed on task_failed[32m 0[2mms[22m[39m
       [32mâœ“[39m should update status to cancelled on task_cancelled[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle sessionId being optional[32m 0[2mms[22m[39m
       [32mâœ“[39m should preserve existing status when adding sessionId[32m 0[2mms[22m[39m
       [32mâœ“[39m should convert AgentStartEvent to TaskStartedEvent[32m 1[2mms[22m[39m
       [32mâœ“[39m should convert AgentOutputEvent to TaskOutputEvent[32m 1[2mms[22m[39m
       [32mâœ“[39m should convert AgentCompleteEvent to TaskCompletedEvent[32m 0[2mms[22m[39m
       [32mâœ“[39m should convert AgentErrorEvent to TaskFailedEvent[32m 0[2mms[22m[39m
       [32mâœ“[39m should convert AgentInterruptEvent to TaskPausedEvent[32m 0[2mms[22m[39m
       [32mâœ“[39m should skip unsupported agent events[32m 0[2mms[22m[39m
       [32mâœ“[39m should emit converted events to stream[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle multiple agent events[32m 0[2mms[22m[39m
       [32mâœ“[39m should remove task status[32m 4[2mms[22m[39m
       [32mâœ“[39m should remove event buffer[32m 0[2mms[22m[39m
       [32mâœ“[39m should remove subscribers[32m 1[2mms[22m[39m
       [32mâœ“[39m should not throw for non-existent task[32m 0[2mms[22m[39m
       [32mâœ“[39m should remove all task statuses[32m 0[2mms[22m[39m
       [32mâœ“[39m should remove all event buffers[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should remove all subscribers[39m[32m 8[2mms[22m[39m
       [32mâœ“[39m should handle rapid event emission[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle subscription to non-existent task[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle empty output concatenation[32m 0[2mms[22m[39m
       [32mâœ“[39m should preserve status across multiple status types[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle checkpoint and approval events[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle concurrent subscriptions and emissions[32m 0[2mms[22m[39m
       [32mâœ“[39m should create a new ProgressStream instance[32m 0[2mms[22m[39m
       [32mâœ“[39m should create independent instances[32m 0[2mms[22m[39m
 [32mâœ“[39m packages/core/src/workflow/__tests__/temporal-engine.test.ts [2m([22m[2m39 tests[22m[2m)[22m[33m 5615[2mms[22m[39m
       [33m[2mâœ“[22m[39m should retry failed activities [33m 302[2mms[22m[39m
       [33m[2mâœ“[22m[39m should use exponential backoff for retries [33m 510[2mms[22m[39m
       [33m[2mâœ“[22m[39m should calculate average workflow duration [33m 335[2mms[22m[39m
       [33m[2mâœ“[22m[39m should pause workflow for human approval [33m 1303[2mms[22m[39m
[90mstderr[2m | packages/core/src/parallel/__tests__/dynamic-worker-pool.test.ts[2m > [22m[2mDynamicWorkerPool[2m > [22m[2mworker lifecycle[2m > [22m[2mshould handle worker spawn failures gracefully
[22m[39mFailed to spawn worker dynamic-worker-1765641491371-wr8m: Error: Spawn failed
    at [90m/Users/prokop/repos/_dxheroes/ado/[39mpackages/core/src/parallel/__tests__/dynamic-worker-pool.test.ts:488:44
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.15_@opentelemetry+api@1.9.0_@types+node@22.19.1_@vitest+ui@4.0.15_jiti@1.21._72a9269ca5867fb31b12a3e8c295d098/node_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.15_@opentelemetry+api@1.9.0_@types+node@22.19.1_@vitest+ui@4.0.15_jiti@1.21._72a9269ca5867fb31b12a3e8c295d098/node_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

[90mstderr[2m | packages/core/src/parallel/__tests__/dynamic-worker-pool.test.ts[2m > [22m[2mDynamicWorkerPool[2m > [22m[2mworker lifecycle[2m > [22m[2mshould handle worker termination failures gracefully
[22m[39mFailed to terminate worker dynamic-worker-1765641491381-izn2: Error: Termination failed
    at [90m/Users/prokop/repos/_dxheroes/ado/[39mpackages/core/src/parallel/__tests__/dynamic-worker-pool.test.ts:514:48
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.15_@opentelemetry+api@1.9.0_@types+node@22.19.1_@vitest+ui@4.0.15_jiti@1.21._72a9269ca5867fb31b12a3e8c295d098/node_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.15_@opentelemetry+api@1.9.0_@types+node@22.19.1_@vitest+ui@4.0.15_jiti@1.21._72a9269ca5867fb31b12a3e8c295d098/node_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [32mâœ“[39m packages/core/src/notifications/manager.test.ts [2m([22m[2m33 tests[22m[2m)[22m[33m 6321[2mms[22m[39m
       [33m[2mâœ“[22m[39m should send to all enabled channels [33m 1294[2mms[22m[39m
       [33m[2mâœ“[22m[39m should add timestamp if not provided [33m 744[2mms[22m[39m
       [33m[2mâœ“[22m[39m should preserve existing timestamp [33m 707[2mms[22m[39m
       [33m[2mâœ“[22m[39m should send to all channels in parallel [33m 616[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle partial failures [33m 735[2mms[22m[39m
       [33m[2mâœ“[22m[39m should send to specific channels only [33m 793[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle unavailable channel [33m 733[2mms[22m[39m
       [33m[2mâœ“[22m[39m should return error for non-existent channel [33m 659[2mms[22m[39m
 [32mâœ“[39m packages/core/src/parallel/__tests__/dynamic-worker-pool.test.ts [2m([22m[2m39 tests[22m[2m)[22m[33m 5527[2mms[22m[39m
       [33m[2mâœ“[22m[39m should execute task on worker [33m 1110[2mms[22m[39m
       [33m[2mâœ“[22m[39m should update worker state during task execution [33m 1108[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle task result [33m 1110[2mms[22m[39m
       [33m[2mâœ“[22m[39m should track worker last used time [33m 1126[2mms[22m[39m
 [32mâœ“[39m packages/cli/src/__tests__/workflow.test.ts [2m([22m[2m24 tests[22m[2m)[22m[33m 6390[2mms[22m[39m
       [33m[2mâœ“[22m[39m should create workflow definition from YAML [33m 2095[2mms[22m[39m
 [32mâœ“[39m packages/core/src/deployment/__tests__/scaling.test.ts [2m([22m[2m40 tests[22m[2m)[22m[33m 796[2mms[22m[39m
 [32mâœ“[39m packages/cli/src/__tests__/config.test.ts [2m([22m[2m24 tests[22m[2m)[22m[33m 6798[2mms[22m[39m
       [33m[2mâœ“[22m[39m should load configuration [33m 1622[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle missing repository field [33m 504[2mms[22m[39m
       [33m[2mâœ“[22m[39m should set string value [33m 540[2mms[22m[39m
       [33m[2mâœ“[22m[39m should set boolean value [33m 418[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle empty providers list [33m 331[2mms[22m[39m
 [32mâœ“[39m packages/cli/src/__tests__/cli-integration.test.ts [2m([22m[2m13 tests[22m[2m)[22m[33m 3063[2mms[22m[39m
       [33m[2mâœ“[22m[39m should create configuration files when ado.config.yaml does not exist [33m 1589[2mms[22m[39m
     [33m[2mâœ“[22m[39m should check adapter availability [33m 1310[2mms[22m[39m
 [32mâœ“[39m packages/core/src/workflow/workflow-engine.test.ts [2m([22m[2m9 tests[22m[2m)[22m[33m 1169[2mms[22m[39m
       [33m[2mâœ“[22m[39m should return true for existing workflow [33m 1002[2mms[22m[39m
 [32mâœ“[39m packages/core/src/telemetry/__tests__/setup.test.ts [2m([22m[2m26 tests[22m[2m)[22m[33m 623[2mms[22m[39m
 [32mâœ“[39m packages/core/src/llm/__tests__/litellm-router.test.ts [2m([22m[2m50 tests[22m[2m)[22m[33m 1283[2mms[22m[39m
       [33m[2mâœ“[22m[39m should estimate input tokens from message content [33m 1204[2mms[22m[39m
 [32mâœ“[39m packages/core/src/provider/router.test.ts [2m([22m[2m12 tests[22m[2m)[22m[33m 659[2mms[22m[39m
 [32mâœ“[39m packages/core/src/queue/task-queue.test.ts [2m([22m[2m9 tests[22m[2m)[22m[33m 625[2mms[22m[39m
Test output
 [32mâœ“[39m packages/core/src/hitl/__tests__/hitl-controller.test.ts [2m([22m[2m70 tests[22m[2m)[22m[33m 3495[2mms[22m[39m
       [33m[2mâœ“[22m[39m should emit approval_timeout event on timeout [33m 366[2mms[22m[39m
       [33m[2mâœ“[22m[39m should emit approval_timeout event with correct data [33m 354[2mms[22m[39m
Error: Rate limit exceeded
Some error
 [32mâœ“[39m packages/adapters/src/copilot-cli/__tests__/adapter.test.ts [2m([22m[2m19 tests[22m[2m)[22m[33m 314[2mms[22m[39m
Test output
 [32mâœ“[39m packages/cli/src/__tests__/run-command.integration.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 504[2mms[22m[39m
Error: Rate limit exceeded
Some error
Line 1
Line 2
 [32mâœ“[39m packages/adapters/src/gemini-cli/__tests__/adapter.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 140[2mms[22m[39m
 [32mâœ“[39m packages/core/src/orchestrator/__tests__/orchestrator-core.test.ts [2m([22m[2m20 tests[22m[2m | [22m[33m1 skipped[39m[2m)[22m[33m 504[2mms[22m[39m
 [32mâœ“[39m packages/mcp-server/src/__tests__/tools.test.ts [2m([22m[2m51 tests[22m[2m)[22m[33m 531[2mms[22m[39m
 [32mâœ“[39m packages/core/src/telemetry/__tests__/metrics.test.ts [2m([22m[2m46 tests[22m[2m)[22m[33m 598[2mms[22m[39m
 [32mâœ“[39m packages/core/src/worker/__tests__/firecracker-sandbox.test.ts [2m([22m[2m40 tests[22m[2m)[22m[33m 343[2mms[22m[39m
Test output
Error: Rate limit exceeded
Some error
 [32mâœ“[39m packages/core/src/checkpoint/checkpoint-manager.test.ts [2m([22m[2m8 tests[22m[2m)[22m[33m 324[2mms[22m[39m
 [32mâœ“[39m packages/adapters/src/codex-cli/__tests__/adapter.test.ts [2m([22m[2m19 tests[22m[2m)[22m[33m 542[2mms[22m[39m
Test output
Error: Rate limit exceeded
 [32mâœ“[39m packages/cli/src/__tests__/status.test.ts [2m([22m[2m21 tests[22m[2m)[22m[33m 5229[2mms[22m[39m
       [33m[2mâœ“[22m[39m should retrieve failed tasks [33m 389[2mms[22m[39m
       [33m[2mâœ“[22m[39m should format task ID to 8 characters [33m 432[2mms[22m[39m
       [33m[2mâœ“[22m[39m should format task with all fields [33m 397[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle empty providers list [33m 385[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle missing state database [33m 378[2mms[22m[39m
Some error
 [32mâœ“[39m packages/api/src/routes/__tests__/dashboard.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 306[2mms[22m[39m
 [32mâœ“[39m packages/adapters/src/cursor-cli/__tests__/adapter.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 282[2mms[22m[39m
 [32mâœ“[39m packages/core/src/autonomous/__tests__/hitl-checkpoint-coordinator.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 53[2mms[22m[39m
 [32mâœ“[39m packages/core/src/state/__tests__/sqlite.test.ts [2m([22m[2m32 tests[22m[2m)[22m[33m 365[2mms[22m[39m
 [32mâœ“[39m packages/api/src/routes/__tests__/tasks.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 257[2mms[22m[39m
[90mstderr[2m | packages/core/src/autonomous/__tests__/auto-fix-engine.test.ts[2m > [22m[2mAutoFixEngine[2m > [22m[2mautoFix[2m > [22m[2mshould handle fix strategy errors gracefully
[22m[39mFix strategy Failing fix failed: Error: Fix failed
    at [90m/Users/prokop/repos/_dxheroes/ado/[39mpackages/core/src/autonomous/__tests__/auto-fix-engine.test.ts:276:46
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.15_@opentelemetry+api@1.9.0_@types+node@22.19.1_@vitest+ui@4.0.15_jiti@1.21._72a9269ca5867fb31b12a3e8c295d098/node_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.15_@opentelemetry+api@1.9.0_@types+node@22.19.1_@vitest+ui@4.0.15_jiti@1.21._72a9269ca5867fb31b12a3e8c295d098/node_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [32mâœ“[39m packages/core/src/provider/__tests__/capability-matcher.test.ts [2m([22m[2m71 tests[22m[2m)[22m[32m 208[2mms[22m[39m
 [32mâœ“[39m packages/core/src/autonomous/__tests__/auto-fix-engine.test.ts [2m([22m[2m23 tests[22m[2m)[22m[32m 215[2mms[22m[39m
 [32mâœ“[39m packages/core/src/config/__tests__/schema.test.ts [2m([22m[2m49 tests[22m[2m)[22m[32m 108[2mms[22m[39m
 [32mâœ“[39m packages/core/src/parallel/__tests__/k8s-autoscaler.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 65[2mms[22m[39m
 [32mâœ“[39m packages/core/src/worker/__tests__/worker-health-monitor.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 226[2mms[22m[39m
 [32mâœ“[39m packages/core/src/config/__tests__/loader.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 275[2mms[22m[39m
 [32mâœ“[39m packages/core/src/worker/__tests__/postgresql-worker-registry.test.ts [2m([22m[2m31 tests[22m[2m)[22m[32m 282[2mms[22m[39m
 [32mâœ“[39m packages/core/src/execution/__tests__/worktree-manager.test.ts [2m([22m[2m34 tests[22m[2m)[22m[33m 303[2mms[22m[39m
 [32mâœ“[39m packages/shared/src/logger.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 71[2mms[22m[39m
 [32mâœ“[39m packages/core/src/telemetry/__tests__/tracer.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 50[2mms[22m[39m
 [32mâœ“[39m packages/mcp-server/src/__tests__/resources.test.ts [2m([22m[2m32 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m packages/core/src/context/__tests__/manager.test.ts [2m([22m[2m40 tests[22m[2m)[22m[32m 43[2mms[22m[39m
 [32mâœ“[39m packages/core/src/worker/__tests__/k8s-worker-spawner.test.ts [2m([22m[2m28 tests[22m[2m)[22m[32m 141[2mms[22m[39m
 [32mâœ“[39m packages/core/src/workflow/__tests__/expression-evaluator.test.ts [2m([22m[2m72 tests[22m[2m)[22m[32m 147[2mms[22m[39m
 [32mâœ“[39m packages/core/src/worker/__tests__/worker-protocol.test.ts [2m([22m[2m70 tests[22m[2m)[22m[32m 78[2mms[22m[39m
 [32mâœ“[39m packages/core/src/autonomous/__tests__/quality-validator.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m packages/core/src/worker/__tests__/worker-registry.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 51[2mms[22m[39m
 [32mâœ“[39m packages/core/src/deployment/__tests__/context-manager.test.ts [2m([22m[2m32 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m packages/shared/src/utils/prompt.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m packages/core/src/autonomous/__tests__/stuck-detector.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 27[2mms[22m[39m
 [32mâœ“[39m packages/core/src/notifications/__tests__/slack.test.ts [2m([22m[2m34 tests[22m[2m)[22m[32m 40[2mms[22m[39m
 [32mâœ“[39m packages/core/src/notifications/__tests__/webhook.test.ts [2m([22m[2m34 tests[22m[2m)[22m[32m 44[2mms[22m[39m
 [32mâœ“[39m packages/core/src/autonomous/task-classifier.test.ts [2m([22m[2m37 tests[22m[2m)[22m[32m 196[2mms[22m[39m
 [32mâœ“[39m packages/core/src/autonomous/__tests__/task-decomposer.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 21[2mms[22m[39m
 [32mâœ“[39m packages/core/src/parallel/__tests__/parallel-scheduler.test.ts [2m([22m[2m17 tests[22m[2m | [22m[33m1 skipped[39m[2m)[22m[32m 28[2mms[22m[39m
 [32mâœ“[39m packages/adapters/src/__tests__/base.test.ts [2m([22m[2m22 tests[22m[2m)[22m[32m 99[2mms[22m[39m
 [32mâœ“[39m packages/core/src/parallel/__tests__/cost-optimizer.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 44[2mms[22m[39m
 [32mâœ“[39m packages/mcp-server/src/__tests__/index.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 212[2mms[22m[39m
 [32mâœ“[39m packages/core/src/notifications/__tests__/email.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m packages/core/src/cost/tracker.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m packages/shared/src/errors.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m packages/core/src/autonomous/__tests__/dependency-graph.test.ts [2m([22m[2m22 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mâœ“[39m packages/api/src/trpc/__tests__/context.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 19[2mms[22m[39m
 [32mâœ“[39m packages/core/src/rate-limit/tracker.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m packages/core/src/provider/registry.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m packages/api/src/trpc/__tests__/router.test.ts [2m([22m[2m20 tests[22m[2m)[22m[32m 5[2mms[22m[39m
[90mstderr[2m | packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22m[2mParallelExecutor[2m > [22m[2mexecuteParallel with worktree isolation[2m > [22m[2mshould handle worktree cleanup errors gracefully
[22m[39mFailed to cleanup worktree wt-task-1: Error: Cleanup failed
    at [90m/Users/prokop/repos/_dxheroes/ado/[39mpackages/core/src/execution/__tests__/parallel-executor.test.ts:247:5
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.15_@opentelemetry+api@1.9.0_@types+node@22.19.1_@vitest+ui@4.0.15_jiti@1.21._72a9269ca5867fb31b12a3e8c295d098/node_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.15_@opentelemetry+api@1.9.0_@types+node@22.19.1_@vitest+ui@4.0.15_jiti@1.21._72a9269ca5867fb31b12a3e8c295d098/node_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/prokop/repos/_dxheroes/ado/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.15/node_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [31mâ¯[39m packages/core/src/execution/__tests__/parallel-executor.test.ts [2m([22m[2m18 tests[22m[2m | [22m[31m12 failed[39m[2m)[22m[33m 346525[2mms[22m[39m
       [32mâœ“[39m should create executor with config[32m 1[2mms[22m[39m
       [32mâœ“[39m should throw error if worktree isolation enabled but no manager provided[32m 1[2mms[22m[39m
       [32mâœ“[39m should accept worktree manager when isolation is enabled[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should execute single task successfully[39m[33m 52564[2mms[22m[39m
[31m       [31mÃ—[31m should execute multiple tasks sequentially[39m[33m 40405[2mms[22m[39m
[31m       [31mÃ—[31m should handle task failures gracefully[39m[33m 41413[2mms[22m[39m
[31m       [31mÃ—[31m should handle mixed success and failure[39m[33m 40883[2mms[22m[39m
       [32mâœ“[39m should handle empty task list[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m should create and use worktree for task execution[39m[32m 6[2mms[22m[39m
[31m       [31mÃ—[31m should update task with worktree path[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should clean up worktree even if task fails[39m[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle worktree cleanup errors gracefully[39m[33m 38928[2mms[22m[39m
       [32mâœ“[39m should return empty array when no tasks are executing[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should clear active executions after completion[39m[33m 33789[2mms[22m[39m
       [32mâœ“[39m should clear active executions[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should include duration for each task[39m[33m 56797[2mms[22m[39m
[31m       [31mÃ—[31m should include error for failed tasks[39m[33m 41716[2mms[22m[39m
[31m       [31mÃ—[31m should include worktree ID when isolation is used[39m[32m 3[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Suites 1 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m packages/core/src/state/__tests__/postgresql.test.ts[2m > [22mPostgresqlStateStore
[31m[1mError[22m: Log stream ended and message "/.*Started.*/" was not received[39m
[90m [2mâ¯[22m LineStream.<anonymous> node_modules/.pnpm/testcontainers@11.10.0/node_modules/testcontainers/build/wait-strategies/log-wait-strategy.js:[2m56:24[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/state/__tests__/postgresql.test.ts[2m > [22mPostgresqlStateStore
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'stop')[39m
[90m [2mâ¯[22m stopPostgresContainer packages/shared/src/test-utils/containers.ts:[2m33:18[22m[39m
[36m [2mâ¯[22m packages/core/src/state/__tests__/postgresql.test.ts:[2m31:9[22m[39m
    [90m 29| [39m [34mafterAll[39m([35masync[39m () [33m=>[39m {
    [90m 30| [39m  [90m// Stop container after all tests[39m
    [90m 31| [39m  [35mawait[39m [34mstopPostgresContainer[39m(container)[33m;[39m
    [90m   | [39m        [31m^[39m
    [90m 32| [39m }[33m,[39m [34m30000[39m)[33m;[39m
    [90m 33| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/96]â¯[22m[39m


[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 94 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/health.test.ts[2m > [22mHealth Routes[2m > [22mGET /health/[2m > [22mshould return status ok
[31m[1mAssertionError[22m: expected 404 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 404[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/health.test.ts:[2m49:23[22m[39m
    [90m 47| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/health/'[39m)[33m;[39m
    [90m 48| [39m
    [90m 49| [39m   [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m 50| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m 51| [39m   [34mexpect[39m(json)[33m.[39m[34mtoHaveProperty[39m([32m'status'[39m[33m,[39m [32m'ok'[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/health.test.ts[2m > [22mHealth Routes[2m > [22mGET /health/[2m > [22mshould return valid timestamp
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/health.test.ts:[2m57:17[22m[39m
    [90m 55| [39m  [34mit[39m([32m'should return valid timestamp'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m 56| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/health/'[39m)[33m;[39m
    [90m 57| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m 58| [39m
    [90m 59| [39m   [35mconst[39m timestamp [33m=[39m [35mnew[39m [33mDate[39m(json[33m.[39mtimestamp)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/health.test.ts[2m > [22mHealth Routes[2m > [22mresponse format[2m > [22mshould return JSON content type
[31m[1mAssertionError[22m: expected 'text/plain; charset=UTF-8' to contain 'application/json'[39m

Expected: [32m"application/json"[39m
Received: [31m"text/plain; charset=UTF-8"[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/health.test.ts:[2m271:44[22m[39m
    [90m269| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/health/'[39m)[33m;[39m
    [90m270| [39m
    [90m271| [39m   expect(res.headers.get('content-type')).toContain('application/jsonâ€¦
    [90m   | [39m                                           [31m^[39m
    [90m272| [39m  })[33m;[39m
    [90m273| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/health.test.ts[2m > [22mHealth Routes[2m > [22mresponse format[2m > [22mshould return valid JSON for all endpoints
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/health.test.ts:[2m279:18[22m[39m
    [90m277| [39m   [35mfor[39m ([35mconst[39m endpoint [35mof[39m endpoints) {
    [90m278| [39m    [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m`/health[39m[36m${[39mendpoint[36m}[39m[32m`[39m)[33m;[39m
    [90m279| [39m    [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m280| [39m
    [90m281| [39m    [34mexpect[39m(json)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[6/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/health.test.ts[2m > [22mHealth Routes[2m > [22mKubernetes compatibility[2m > [22mshould support liveness probe
[31m[1mAssertionError[22m: expected 404 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 404[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/health.test.ts:[2m292:23[22m[39m
    [90m290| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/health/'[39m)[33m;[39m
    [90m291| [39m
    [90m292| [39m   [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m293| [39m  })[33m;[39m
    [90m294| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[7/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mGET /providers/[2m > [22mshould list all providers
[31m[1mAssertionError[22m: expected 404 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 404[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m47:23[22m[39m
    [90m 45| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m 46| [39m
    [90m 47| [39m   [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m 48| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m 49| [39m   [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(json))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[8/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mGET /providers/[2m > [22mshould return provider configuration
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m54:17[22m[39m
    [90m 52| [39m  [34mit[39m([32m'should return provider configuration'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m 53| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m 54| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m 55| [39m
    [90m 56| [39m   [35mif[39m (json[33m.[39mlength [33m>[39m [34m0[39m) {

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[9/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mGET /providers/[2m > [22mshould include access modes
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m69:17[22m[39m
    [90m 67| [39m  [34mit[39m([32m'should include access modes'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m 68| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m 69| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m 70| [39m
    [90m 71| [39m   [35mif[39m (json[33m.[39mlength [33m>[39m [34m0[39m) {

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[10/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mGET /providers/[2m > [22mshould include capabilities
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m84:17[22m[39m
    [90m 82| [39m  [34mit[39m([32m'should include capabilities'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m 83| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m 84| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m 85| [39m
    [90m 86| [39m   [35mif[39m (json[33m.[39mlength [33m>[39m [34m0[39m) {

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[11/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mGET /providers/[2m > [22mshould include usage data
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m99:17[22m[39m
    [90m 97| [39m  [34mit[39m([32m'should include usage data'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m 98| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m 99| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m100| [39m
    [90m101| [39m   [35mif[39m (json[33m.[39mlength [33m>[39m [34m0[39m) {

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[12/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mGET /providers/[2m > [22mshould fallback to default providers on config error
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m112:17[22m[39m
    [90m110| [39m
    [90m111| [39m   [35mconst[39m res [33m=[39m [35mawait[39m appWithoutConfig[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m112| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m113| [39m
    [90m114| [39m   [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(json))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[13/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mGET /providers/[2m > [22mshould include rate limits when available
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m120:17[22m[39m
    [90m118| [39m  [34mit[39m([32m'should include rate limits when available'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m119| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m120| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m121| [39m
    [90m122| [39m   [35mconst[39m providerWithLimits [33m=[39m json[33m.[39m[34mfind[39m((p[33m:[39m any) [33m=>[39m p[33m.[39mrateLimits)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[14/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mGET /providers/:id/usage[2m > [22mshould handle provider without rate limits
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m266:23[22m[39m
    [90m264| [39m
    [90m265| [39m   [34mexpect[39m(json)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m266| [39m   [34mexpect[39m(json[33m.[39musage)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m267| [39m  })[33m;[39m
    [90m268| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[15/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mprovider types[2m > [22mshould include subscription providers
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m292:17[22m[39m
    [90m290| [39m  [34mit[39m([32m'should include subscription providers'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m291| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m292| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m293| [39m
    [90m294| [39m   [35mconst[39m subscriptionProvider [33m=[39m json[33m.[39m[34mfind[39m((p[33m:[39m any) [33m=>[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[16/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mprovider types[2m > [22mshould include API providers
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m303:17[22m[39m
    [90m301| [39m  [34mit[39m([32m'should include API providers'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m302| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m303| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m304| [39m
    [90m305| [39m   [35mconst[39m apiProvider [33m=[39m json[33m.[39m[34mfind[39m((p[33m:[39m any) [33m=>[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[17/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mprovider types[2m > [22mshould include free providers
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m314:17[22m[39m
    [90m312| [39m  [34mit[39m([32m'should include free providers'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m313| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m314| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m315| [39m
    [90m316| [39m   [35mconst[39m freeProvider [33m=[39m json[33m.[39m[34mfind[39m((p[33m:[39m any) [33m=>[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[18/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22menabled/disabled providers[2m > [22mshould include both enabled and disabled providers
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m327:17[22m[39m
    [90m325| [39m  it('should include both enabled and disabled providers', async () =>â€¦
    [90m326| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m327| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m328| [39m
    [90m329| [39m   [35mconst[39m enabledProvider [33m=[39m json[33m.[39m[34mfind[39m((p[33m:[39m any) [33m=>[39m p[33m.[39menabled [33m===[39m [35mtrue[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[19/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22menabled/disabled providers[2m > [22mshould mark codex-cli as disabled by default
[31m[1mAssertionError[22m: expected undefined to be false // Object.is equality[39m

[32m- Expected:[39m 
false

[31m+ Received:[39m 
undefined

[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m343:25[22m[39m
    [90m341| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m342| [39m
    [90m343| [39m   [34mexpect[39m(json[33m.[39menabled)[33m.[39m[34mtoBe[39m([35mfalse[39m)[33m;[39m
    [90m   | [39m                        [31m^[39m
    [90m344| [39m  })[33m;[39m
    [90m345| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[20/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mresponse format[2m > [22mshould return JSON content type
[31m[1mAssertionError[22m: expected 'text/plain; charset=UTF-8' to contain 'application/json'[39m

Expected: [32m"application/json"[39m
Received: [31m"text/plain; charset=UTF-8"[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m351:44[22m[39m
    [90m349| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m350| [39m
    [90m351| [39m   expect(res.headers.get('content-type')).toContain('application/jsonâ€¦
    [90m   | [39m                                           [31m^[39m
    [90m352| [39m  })[33m;[39m
    [90m353| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[21/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mresponse format[2m > [22mshould return valid JSON for all endpoints
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m363:18[22m[39m
    [90m361| [39m   [35mfor[39m ([35mconst[39m endpoint [35mof[39m endpoints) {
    [90m362| [39m    [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m`/providers[39m[36m${[39mendpoint[36m}[39m[32m`[39m)[33m;[39m
    [90m363| [39m    [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m364| [39m
    [90m365| [39m    [34mexpect[39m(json)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[22/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22merror handling[2m > [22mshould handle config loading errors gracefully
[31m[1mAssertionError[22m: expected 404 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 404[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m378:23[22m[39m
    [90m376| [39m   [35mconst[39m res [33m=[39m [35mawait[39m appWithBadConfig[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m377| [39m
    [90m378| [39m   [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m379| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m380| [39m   [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(json))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[23/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22merror handling[2m > [22mshould handle state store errors in usage tracking
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m389:17[22m[39m
    [90m387| [39m
    [90m388| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m389| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m390| [39m
    [90m391| [39m   [90m// Should still return providers with zero usage[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[24/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22musage tracking from state store[2m > [22mshould fetch usage from state store
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m412:17[22m[39m
    [90m410| [39m
    [90m411| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m412| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m413| [39m
    [90m414| [39m   const claudeProvider = json.find((p: any) => p.id === 'claude-code'â€¦

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[25/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22musage tracking from state store[2m > [22mshould aggregate multiple usage records
[31m[1mSyntaxError[22m: Unexpected non-whitespace character after JSON at position 4 (line 1 column 5)[39m
[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m443:17[22m[39m
    [90m441| [39m
    [90m442| [39m   [35mconst[39m res [33m=[39m [35mawait[39m app[33m.[39m[34mrequest[39m([32m'/providers/'[39m)[33m;[39m
    [90m443| [39m   [35mconst[39m json [33m=[39m [35mawait[39m res[33m.[39m[34mjson[39m()[33m;[39m
    [90m   | [39m                [31m^[39m
    [90m444| [39m
    [90m445| [39m   const claudeProvider = json.find((p: any) => p.id === 'claude-code'â€¦

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[26/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mdefault providers[2m > [22mshould include gemini-cli
[31m[1mAssertionError[22m: expected 404 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 404[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m468:23[22m[39m
    [90m466| [39m   [35mconst[39m res [33m=[39m [35mawait[39m appWithoutConfig[33m.[39m[34mrequest[39m([32m'/providers/gemini-cli'[39m)[33m;[39m
    [90m467| [39m
    [90m468| [39m   [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m469| [39m  })[33m;[39m
    [90m470| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[27/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mdefault providers[2m > [22mshould include cursor-cli
[31m[1mAssertionError[22m: expected 404 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 404[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m477:23[22m[39m
    [90m475| [39m   [35mconst[39m res [33m=[39m [35mawait[39m appWithoutConfig[33m.[39m[34mrequest[39m([32m'/providers/cursor-cli'[39m)[33m;[39m
    [90m476| [39m
    [90m477| [39m   [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m478| [39m  })[33m;[39m
    [90m479| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[28/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mdefault providers[2m > [22mshould include copilot-cli
[31m[1mAssertionError[22m: expected 404 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 404[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m486:23[22m[39m
    [90m484| [39m   const res = await appWithoutConfig.request('/providers/copilot-cli'â€¦
    [90m485| [39m
    [90m486| [39m   [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m487| [39m  })[33m;[39m
    [90m488| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[29/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/routes/__tests__/providers.test.ts[2m > [22mProviders Routes[2m > [22mdefault providers[2m > [22mshould include codex-cli
[31m[1mAssertionError[22m: expected 404 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 404[39m

[36m [2mâ¯[22m packages/api/src/routes/__tests__/providers.test.ts:[2m495:23[22m[39m
    [90m493| [39m   [35mconst[39m res [33m=[39m [35mawait[39m appWithoutConfig[33m.[39m[34mrequest[39m([32m'/providers/codex-cli'[39m)[33m;[39m
    [90m494| [39m
    [90m495| [39m   [34mexpect[39m(res[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m496| [39m  })[33m;[39m
    [90m497| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[30/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould emit complete event on success
[31m[1mAssertionError[22m: expected undefined to be defined[39m
[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m226:26[22m[39m
    [90m224| [39m
    [90m225| [39m   [35mconst[39m completeEvent [33m=[39m events[33m.[39m[34mfind[39m((e) [33m=>[39m e[33m.[39mtype [33m===[39m [32m'complete'[39m)[33m;[39m
    [90m226| [39m   [34mexpect[39m(completeEvent)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m227| [39m   [34mexpect[39m(completeEvent[33m?.[39mtype)[33m.[39m[34mtoBe[39m([32m'complete'[39m)[33m;[39m
    [90m228| [39m   [35mif[39m (completeEvent[33m?.[39mtype [33m===[39m [32m'complete'[39m) {

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[31/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould emit error event on failure
[31m[1mAssertionError[22m: expected '[vitest] No "statSync" export is defiâ€¦' to contain 'exited with code 1'[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- exited with code 1[39m
[31m+ [vitest] No "statSync" export is defined on the "node:fs" mock. Did you forget to return it from "vi.mock"?[39m
[31m+ If you need to partially mock a module, you can use "importOriginal" helper inside:[39m
[31m+[39m

[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m268:38[22m[39m
    [90m266| [39m   [34mexpect[39m(errorEvent[33m?.[39mtype)[33m.[39m[34mtoBe[39m([32m'error'[39m)[33m;[39m
    [90m267| [39m   [35mif[39m (errorEvent[33m?.[39mtype [33m===[39m [32m'error'[39m) {
    [90m268| [39m    [34mexpect[39m(errorEvent[33m.[39merror[33m.[39mmessage)[33m.[39m[34mtoContain[39m([32m'exited with code 1'[39m)[33m;[39m
    [90m   | [39m                                     [31m^[39m
    [90m269| [39m   }
    [90m270| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[32/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould spawn claude with correct arguments
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'claude', ArrayContaining{â€¦}, â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m296:18[22m[39m
    [90m294| [39m   [35mawait[39m [35mnew[39m [33mPromise[39m((resolve) [33m=>[39m [34msetTimeout[39m(resolve[33m,[39m [34m10[39m))[33m;[39m
    [90m295| [39m
    [90m296| [39m   [34mexpect[39m(spawn)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                 [31m^[39m
    [90m297| [39m    [32m'claude'[39m[33m,[39m
    [90m298| [39m    expect[33m.[39m[34marrayContaining[39m([[32m'-p'[39m[33m,[39m [32m'Test prompt'[39m])[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[33/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould support resume option
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'claude', ArrayContaining{â€¦}, â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m339:18[22m[39m
    [90m337| [39m   [35mawait[39m [35mnew[39m [33mPromise[39m((resolve) [33m=>[39m [34msetTimeout[39m(resolve[33m,[39m [34m10[39m))[33m;[39m
    [90m338| [39m
    [90m339| [39m   [34mexpect[39m(spawn)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                 [31m^[39m
    [90m340| [39m    [32m'claude'[39m[33m,[39m
    [90m341| [39m    expect[33m.[39m[34marrayContaining[39m([[32m'--resume'[39m[33m,[39m [32m'existing-session'[39m])[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[34/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould support model option
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'claude', ArrayContaining{â€¦}, â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m377:18[22m[39m
    [90m375| [39m   [35mawait[39m [35mnew[39m [33mPromise[39m((resolve) [33m=>[39m [34msetTimeout[39m(resolve[33m,[39m [34m10[39m))[33m;[39m
    [90m376| [39m
    [90m377| [39m   [34mexpect[39m(spawn)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                 [31m^[39m
    [90m378| [39m    [32m'claude'[39m[33m,[39m
    [90m379| [39m    expect[33m.[39m[34marrayContaining[39m([[32m'--model'[39m[33m,[39m [32m'claude-opus-4'[39m])[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[35/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould support maxTurns option
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'claude', ArrayContaining{â€¦}, â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m415:18[22m[39m
    [90m413| [39m   [35mawait[39m [35mnew[39m [33mPromise[39m((resolve) [33m=>[39m [34msetTimeout[39m(resolve[33m,[39m [34m10[39m))[33m;[39m
    [90m414| [39m
    [90m415| [39m   [34mexpect[39m(spawn)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                 [31m^[39m
    [90m416| [39m    [32m'claude'[39m[33m,[39m
    [90m417| [39m    expect[33m.[39m[34marrayContaining[39m([[32m'--max-turns'[39m[33m,[39m [32m'10'[39m])[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[36/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould support permissionMode option
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'claude', ArrayContaining{â€¦}, â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m453:18[22m[39m
    [90m451| [39m   [35mawait[39m [35mnew[39m [33mPromise[39m((resolve) [33m=>[39m [34msetTimeout[39m(resolve[33m,[39m [34m10[39m))[33m;[39m
    [90m452| [39m
    [90m453| [39m   [34mexpect[39m(spawn)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                 [31m^[39m
    [90m454| [39m    [32m'claude'[39m[33m,[39m
    [90m455| [39m    expect[33m.[39m[34marrayContaining[39m([[32m'--permission-mode'[39m[33m,[39m [32m'acceptEdits'[39m])[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[37/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould handle process errors
[31m[1mError[22m: Spawn failed[39m
[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m489:30[22m[39m
    [90m487| [39m
    [90m488| [39m   [90m// Simulate process error[39m
    [90m489| [39m   mockProcess[33m.[39m[34memit[39m([32m'error'[39m[33m,[39m [35mnew[39m [33mError[39m([32m'Spawn failed'[39m))[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m490| [39m
    [90m491| [39m   [35mconst[39m events [33m=[39m [35mawait[39m eventsPromise[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[38/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22mexecute[2m > [22mshould mark SIGINT errors as recoverable
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m529:36[22m[39m
    [90m527| [39m   [34mexpect[39m(errorEvent)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m528| [39m   [35mif[39m (errorEvent[33m?.[39mtype [33m===[39m [32m'error'[39m) {
    [90m529| [39m    [34mexpect[39m(errorEvent[33m.[39mrecoverable)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m530| [39m   }
    [90m531| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[39/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/adapters/src/claude-code/__tests__/adapter.test.ts[2m > [22mClaudeCodeAdapter[2m > [22minterrupt[2m > [22mshould kill the running process
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'SIGINT' ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m packages/adapters/src/claude-code/__tests__/adapter.test.ts:[2m563:29[22m[39m
    [90m561| [39m   [35mawait[39m adapter[33m.[39m[34minterrupt[39m()[33m;[39m
    [90m562| [39m
    [90m563| [39m   [34mexpect[39m(mockProcess[33m.[39mkill)[33m.[39m[34mtoHaveBeenCalledWith[39m([32m'SIGINT'[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m564| [39m
    [90m565| [39m   [90m// Complete the process[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[40/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/__tests__/trpc.test.ts[2m > [22mtRPC Initialization[2m > [22mwithStateStore middleware[2m > [22mshould throw error when state store is not configured
[31m[1mAssertionError[22m: expected [Function] to throw error including 'State store not configured' but got '(0 , __vite_ssr_import_1__.withStateSâ€¦'[39m

Expected: [32m"State[7m s[27mtore[7m not configured[27m"[39m
Received: [31m"[7m(0 , __vite_ssr_import_1__.with[27mState[7mS[27mtore[7m) is not a function[27m"[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[41/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/__tests__/trpc.test.ts[2m > [22mtRPC Initialization[2m > [22mwithStateStore middleware[2m > [22mshould call next when state store is configured
[31m[1mTypeError[22m: (0 , __vite_ssr_import_1__.withStateStore) is not a function[39m
[36m [2mâ¯[22m packages/api/src/trpc/__tests__/trpc.test.ts:[2m161:25[22m[39m
    [90m159| [39m   [35mconst[39m next [33m=[39m vi[33m.[39m[34mfn[39m()[33m.[39m[34mmockResolvedValue[39m(nextResult)[33m;[39m
    [90m160| [39m
    [90m161| [39m   [35mconst[39m result [33m=[39m [35mawait[39m [34mwithStateStore[39m({
    [90m   | [39m                        [31m^[39m
    [90m162| [39m    ctx[33m,[39m
    [90m163| [39m    next[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[42/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/__tests__/trpc.test.ts[2m > [22mtRPC Initialization[2m > [22mwithStateStore middleware[2m > [22mshould pass state store in context to next
[31m[1mTypeError[22m: (0 , __vite_ssr_import_1__.withStateStore) is not a function[39m
[36m [2mâ¯[22m packages/api/src/trpc/__tests__/trpc.test.ts:[2m190:10[22m[39m
    [90m188| [39m   })[33m;[39m
    [90m189| [39m
    [90m190| [39m   [35mawait[39m [34mwithStateStore[39m({
    [90m   | [39m         [31m^[39m
    [90m191| [39m    ctx[33m,[39m
    [90m192| [39m    next[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[43/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/doc-first-workflow.test.ts[2m > [22mDocFirstWorkflow[2m > [22mworkflow state[2m > [22mshould initialize state correctly
[31m[1mAssertionError[22m: expected [ 'task-1' ] to deeply equal [][39m

[32m- Expected[39m
[31m+ Received[39m

[32m- [][39m
[31m+ [[39m
[31m+   "task-1",[39m
[31m+ ][39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/doc-first-workflow.test.ts:[2m217:40[22m[39m
    [90m215| [39m
    [90m216| [39m   [34mexpect[39m(result[33m.[39mstate[33m.[39mcurrentTaskIndex)[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m217| [39m   [34mexpect[39m(result[33m.[39mstate[33m.[39mcompletedTasks)[33m.[39m[34mtoEqual[39m([])[33m;[39m
    [90m   | [39m                                       [31m^[39m
    [90m218| [39m   [34mexpect[39m(result[33m.[39mstate[33m.[39mfailedTasks)[33m.[39m[34mtoEqual[39m([])[33m;[39m
    [90m219| [39m   [34mexpect[39m(result[33m.[39mstate[33m.[39mvalidationReports)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[44/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/doc-first-workflow.test.ts[2m > [22mDocFirstWorkflow[2m > [22mimplementation phase[2m > [22mshould apply auto-fixes when validation fails
[31m[1mAssertionError[22m: expected 1 to be greater than 1[39m
[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/doc-first-workflow.test.ts:[2m463:22[22m[39m
    [90m461| [39m
    [90m462| [39m   [90m// Should have attempted auto-fix[39m
    [90m463| [39m   [34mexpect[39m(callCount)[33m.[39m[34mtoBeGreaterThan[39m([34m1[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m464| [39m  })[33m;[39m
    [90m465| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[45/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/escalation-engine.test.ts[2m > [22mEscalationEngine[2m > [22mdecide - not stuck scenarios[2m > [22mshould suggest different approach after max retries
[31m[1mAssertionError[22m: expected 'retry' to be 'different_approach' // Object.is equality[39m

Expected: [32m"different_approach"[39m
Received: [31m"retry"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/escalation-engine.test.ts:[2m169:27[22m[39m
    [90m167| [39m   [35mconst[39m decision [33m=[39m engine[33m.[39m[34mdecide[39m(context)[33m;[39m
    [90m168| [39m
    [90m169| [39m   [34mexpect[39m(decision[33m.[39mlevel)[33m.[39m[34mtoBe[39m([32m'different_approach'[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m170| [39m   [34mexpect[39m(decision[33m.[39mcanAutoResolve)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m171| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[46/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/escalation-engine.test.ts[2m > [22mEscalationEngine[2m > [22mdecide - identical errors[2m > [22mshould suggest partial completion after max approaches
[31m[1mAssertionError[22m: expected 'different_approach' to be 'partial_completion' // Object.is equality[39m

Expected: [32m"partial_completion"[39m
Received: [31m"different_approach"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/escalation-engine.test.ts:[2m221:27[22m[39m
    [90m219| [39m   [35mconst[39m decision [33m=[39m engine[33m.[39m[34mdecide[39m(context)[33m;[39m
    [90m220| [39m
    [90m221| [39m   [34mexpect[39m(decision[33m.[39mlevel)[33m.[39m[34mtoBe[39m([32m'partial_completion'[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m222| [39m   [34mexpect[39m(decision[33m.[39mrequiresHuman)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m223| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[47/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/escalation-engine.test.ts[2m > [22mEscalationEngine[2m > [22mdecide - no progress[2m > [22mshould escalate to human when partial completion not allowed
[31m[1mAssertionError[22m: expected 'different_approach' to be 'human_intervention' // Object.is equality[39m

Expected: [32m"[7mhuman_int[27mer[7mv[27ment[7mion[27m"[39m
Received: [31m"[7mdiff[27merent[7m_approach[27m"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/escalation-engine.test.ts:[2m276:27[22m[39m
    [90m274| [39m   [35mconst[39m decision [33m=[39m customEngine[33m.[39m[34mdecide[39m(context)[33m;[39m
    [90m275| [39m
    [90m276| [39m   [34mexpect[39m(decision[33m.[39mlevel)[33m.[39m[34mtoBe[39m([32m'human_intervention'[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m277| [39m   expect(decision.reason).toContain('No progress after multiple approâ€¦
    [90m278| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[48/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/escalation-engine.test.ts[2m > [22mEscalationEngine[2m > [22mdecide - oscillating[2m > [22mshould escalate to human after one failed approach for oscillating
[31m[1mAssertionError[22m: expected 'different_approach' to be 'human_intervention' // Object.is equality[39m

Expected: [32m"[7mhuman_int[27mer[7mv[27ment[7mion[27m"[39m
Received: [31m"[7mdiff[27merent[7m_approach[27m"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/escalation-engine.test.ts:[2m370:27[22m[39m
    [90m368| [39m   [35mconst[39m decision [33m=[39m engine[33m.[39m[34mdecide[39m(context)[33m;[39m
    [90m369| [39m
    [90m370| [39m   [34mexpect[39m(decision[33m.[39mlevel)[33m.[39m[34mtoBe[39m([32m'human_intervention'[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m371| [39m   [34mexpect[39m(decision[33m.[39mreason)[33m.[39m[34mtoContain[39m([32m'oscillating'[39m)[33m;[39m
    [90m372| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[49/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/escalation-engine.test.ts[2m > [22mEscalationEngine[2m > [22mdecide - test failure loop[2m > [22mshould escalate to human after retry for test failures
[31m[1mAssertionError[22m: expected 'retry' to be 'human_intervention' // Object.is equality[39m

Expected: [32m"human_intervention"[39m
Received: [31m"retry"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/escalation-engine.test.ts:[2m417:27[22m[39m
    [90m415| [39m   [35mconst[39m decision [33m=[39m engine[33m.[39m[34mdecide[39m(context)[33m;[39m
    [90m416| [39m
    [90m417| [39m   [34mexpect[39m(decision[33m.[39mlevel)[33m.[39m[34mtoBe[39m([32m'human_intervention'[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m418| [39m   [34mexpect[39m(decision[33m.[39mreason)[33m.[39m[34mtoContain[39m([32m'test failures'[39m)[33m;[39m
    [90m419| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[50/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/escalation-engine.test.ts[2m > [22mEscalationEngine[2m > [22mdecision properties[2m > [22mshould provide handoff guidance for partial completion
[31m[1mAssertionError[22m: expected 'different_approach' to be 'partial_completion' // Object.is equality[39m

Expected: [32m"partial_completion"[39m
Received: [31m"different_approach"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/escalation-engine.test.ts:[2m563:27[22m[39m
    [90m561| [39m   [35mconst[39m decision [33m=[39m engine[33m.[39m[34mdecide[39m(context)[33m;[39m
    [90m562| [39m
    [90m563| [39m   [34mexpect[39m(decision[33m.[39mlevel)[33m.[39m[34mtoBe[39m([32m'partial_completion'[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m564| [39m   [34mexpect[39m(decision[33m.[39msuggestedNextSteps[33m.[39m[34msome[39m((step) [33m=>[39m
    [90m565| [39m    step[33m.[39m[34mtoLowerCase[39m()[33m.[39m[34mincludes[39m([32m'handoff'[39m)[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[51/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/escalation-engine.test.ts[2m > [22mEscalationEngine[2m > [22mdecision properties[2m > [22mshould provide clear guidance for human intervention
[31m[1mAssertionError[22m: expected 'different_approach' to be 'human_intervention' // Object.is equality[39m

Expected: [32m"[7mhuman_int[27mer[7mv[27ment[7mion[27m"[39m
Received: [31m"[7mdiff[27merent[7m_approach[27m"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/escalation-engine.test.ts:[2m588:27[22m[39m
    [90m586| [39m   [35mconst[39m decision [33m=[39m engine[33m.[39m[34mdecide[39m(context)[33m;[39m
    [90m587| [39m
    [90m588| [39m   [34mexpect[39m(decision[33m.[39mlevel)[33m.[39m[34mtoBe[39m([32m'human_intervention'[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m589| [39m   [34mexpect[39m(decision[33m.[39mactions)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m590| [39m   [34mexpect[39m(decision[33m.[39mactions[33m.[39m[34msome[39m((action) [33m=>[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[52/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/pr-agent-integration.test.ts[2m > [22mPRAgent[2m > [22mupdateChangelog[2m > [22mshould detect breaking changes in changelog
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/pr-agent-integration.test.ts:[2m368:45[22m[39m
    [90m366| [39m   [35mconst[39m changelog [33m=[39m [35mawait[39m prAgent[33m.[39m[34mupdateChangelog[39m(prData)[33m;[39m
    [90m367| [39m
    [90m368| [39m   [34mexpect[39m(changelog[33m.[39mchanges[33m.[39mchanged[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                            [31m^[39m
    [90m369| [39m  })[33m;[39m
    [90m370| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[53/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/pr-agent-integration.test.ts[2m > [22mPRAgent[2m > [22msecurity patterns[2m > [22mshould match security-sensitive file patterns
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/pr-agent-integration.test.ts:[2m541:41[22m[39m
    [90m539| [39m
    [90m540| [39m    [35mif[39m (testCase[33m.[39mshouldMatch) {
    [90m541| [39m     [34mexpect[39m(review[33m.[39mrequiresHumanReview)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                        [31m^[39m
    [90m542| [39m    }
    [90m543| [39m   }

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[54/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/pr-agent-integration.test.ts[2m > [22mPRAgent[2m > [22msecurity patterns[2m > [22mshould match human review required patterns
[31m[1mAssertionError[22m: expected 'Score too low (64/100) for auto-approâ€¦' to contain 'infrastructure'[39m

Expected: [32m"infrastructure"[39m
Received: [31m"Score too low (64/100) for auto-approval"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/pr-agent-integration.test.ts:[2m563:38[22m[39m
    [90m561| [39m
    [90m562| [39m    [34mexpect[39m(review[33m.[39mrequiresHumanReview)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m563| [39m    [34mexpect[39m(review[33m.[39mhumanReviewReason)[33m.[39m[34mtoContain[39m([32m'infrastructure'[39m)[33m;[39m
    [90m   | [39m                                     [31m^[39m
    [90m564| [39m   }
    [90m565| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[55/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/recovery-manager.test.ts[2m > [22mRecoveryManager[2m > [22mwithRetry[2m > [22mshould retry on retryable error
[31m[1mError[22m: RATE_LIMIT[39m
[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/recovery-manager.test.ts:[2m145:28[22m[39m
    [90m143| [39m   [35mconst[39m operation [33m=[39m vi
    [90m144| [39m    [33m.[39m[34mfn[39m()
    [90m145| [39m    [33m.[39m[34mmockRejectedValueOnce[39m([35mnew[39m [33mError[39m([32m'RATE_LIMIT'[39m))
    [90m   | [39m                           [31m^[39m
    [90m146| [39m    [33m.[39m[34mmockResolvedValue[39m([32m'success'[39m)[33m;[39m
    [90m147| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[56/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/recovery-manager.test.ts[2m > [22mRecoveryManager[2m > [22mdetermineStrategy[2m > [22mshould suggest retry for retryable errors within limit
[31m[1mAssertionError[22m: expected 'abort' to be 'retry' // Object.is equality[39m

Expected: [32m"retry"[39m
Received: [31m"abort"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/recovery-manager.test.ts:[2m389:21[22m[39m
    [90m387| [39m   [35mconst[39m strategy [33m=[39m recoveryManager[33m.[39m[34mdetermineStrategy[39m(error[33m,[39m [34m1[39m)[33m;[39m
    [90m388| [39m
    [90m389| [39m   [34mexpect[39m(strategy)[33m.[39m[34mtoBe[39m([32m'retry'[39m)[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m390| [39m  })[33m;[39m
    [90m391| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[57/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/recovery-manager.test.ts[2m > [22mRecoveryManager[2m > [22merror detection[2m > [22mshould detect timeout in error message
[31m[1mAssertionError[22m: expected 'abort' to be 'retry' // Object.is equality[39m

Expected: [32m"retry"[39m
Received: [31m"abort"[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/recovery-manager.test.ts:[2m583:22[22m[39m
    [90m581| [39m   [35mfor[39m ([35mconst[39m error [35mof[39m errors) {
    [90m582| [39m    [35mconst[39m strategy [33m=[39m manager[33m.[39m[34mdetermineStrategy[39m(error[33m,[39m [34m1[39m)[33m;[39m
    [90m583| [39m    [34mexpect[39m(strategy)[33m.[39m[34mtoBe[39m([32m'retry'[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m584| [39m   }
    [90m585| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[58/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/spec-generator.test.ts[2m > [22mSpecGenerator[2m > [22mtoMarkdown[2m > [22mshould convert specification to markdown
[31m[1mAssertionError[22m: expected '# Feature Specification\n\n**Version*â€¦' to contain 'Version:'[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Version:[39m
[31m+ # Feature Specification[39m
[31m+[39m
[31m+ **Version**: 1.0.0  [39m
[31m+ **Status**: draft  [39m
[31m+ **Created**: 12/13/2025  [39m
[31m+ **Updated**: 12/13/2025  [39m
[31m+[39m
[31m+ **Tags**: feature, specification  [39m
[31m+[39m
[31m+ ---[39m
[31m+[39m
[31m+ # Overview[39m
[31m+[39m
[31m+ Add feature[39m
[31m+[39m
[31m+ ## Goals[39m
[31m+[39m
[31m+ - [39m
[31m+[39m
[31m+ ## Non-Goals[39m
[31m+[39m
[31m+ - [39m
[31m+[39m
[31m+[39m
[31m+ # Requirements[39m
[31m+[39m
[31m+ ## Functional Requirements[39m
[31m+[39m
[31m+ 1. [39m
[31m+[39m
[31m+ ## Non-Functional Requirements[39m
[31m+[39m
[31m+ 1. [39m
[31m+[39m
[31m+[39m
[31m+ # Design[39m
[31m+[39m
[31m+ ## Architecture[39m
[31m+[39m
[31m+ ## Data Models[39m
[31m+[39m
[31m+ ## API Contracts[39m
[31m+[39m
[31m+ ## User Interface[39m
[31m+[39m
[31m+[39m
[31m+ # Implementation Plan[39m
[31m+[39m
[31m+ ## Phases[39m
[31m+[39m
[31m+ ### Phase 1: Foundation[39m
[31m+[39m
[31m+ ### Phase 2: Core Features[39m
[31m+[39m
[31m+ ### Phase 3: Polish & Testing[39m
[31m+[39m
[31m+ ## Dependencies[39m
[31m+[39m
[31m+ ## Risks & Mitigations[39m
[31m+[39m
[31m+[39m
[31m+ # Testing Strategy[39m
[31m+[39m
[31m+ ## Unit Tests[39m
[31m+[39m
[31m+ ## Integration Tests[39m
[31m+[39m
[31m+ ## E2E Tests[39m
[31m+[39m
[31m+ ## Performance Tests[39m
[31m+[39m
[31m+ ## Security Tests[39m
[31m+[39m
[31m+[39m
[31m+ # Acceptance Criteria[39m
[31m+[39m
[31m+ - [ ] [39m
[31m+[39m
[31m+[39m
[31m+[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/spec-generator.test.ts:[2m527:21[22m[39m
    [90m525| [39m
    [90m526| [39m   [34mexpect[39m(markdown)[33m.[39m[34mtoContain[39m([32m'# '[39m)[33m;[39m
    [90m527| [39m   [34mexpect[39m(markdown)[33m.[39m[34mtoContain[39m([32m'Version:'[39m)[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m528| [39m   [34mexpect[39m(markdown)[33m.[39m[34mtoContain[39m([32m'Status:'[39m)[33m;[39m
    [90m529| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[59/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/spec-generator.test.ts[2m > [22mSpecGenerator[2m > [22madrToMarkdown[2m > [22mshould convert ADR to markdown
[31m[1mAssertionError[22m: expected '# Implement Feature Specification\n\nâ€¦' to contain 'Status:'[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Status:[39m
[31m+ # Implement Feature Specification[39m
[31m+[39m
[31m+ **ID**: adr-1765641480502  [39m
[31m+ **Status**: proposed  [39m
[31m+ **Date**: 12/13/2025  [39m
[31m+[39m
[31m+ ---[39m
[31m+[39m
[31m+ ## Context[39m
[31m+[39m
[31m+ Implement feature[39m
[31m+[39m
[31m+ This feature requires architectural decisions about implementation approach.[39m
[31m+[39m
[31m+ ## Decision[39m
[31m+[39m
[31m+ Describe the decision and its rationale.[39m
[31m+[39m
[31m+ ## Consequences[39m
[31m+[39m
[31m+ ### Positive[39m
[31m+[39m
[31m+ - Benefit 1[39m
[31m+ - Benefit 2[39m
[31m+[39m
[31m+ ### Negative[39m
[31m+[39m
[31m+ - Tradeoff 1[39m
[31m+ - Tradeoff 2[39m
[31m+[39m
[31m+ ### Risks[39m
[31m+[39m
[31m+ - Risk 1[39m
[31m+ - Risk 2[39m
[31m+[39m
[31m+ ## Alternatives Considered[39m
[31m+[39m
[31m+ ### Alternative 1[39m
[31m+[39m
[31m+ Description of alternative approach[39m
[31m+[39m
[31m+ **Pros:**[39m
[31m+ - Pro 1[39m
[31m+[39m
[31m+ **Cons:**[39m
[31m+ - Con 1[39m
[31m+[39m
[31m+ **Why not chosen**: Reason why this approach was not selected[39m
[31m+[39m
[31m+[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/spec-generator.test.ts:[2m588:22[22m[39m
    [90m586| [39m
    [90m587| [39m    [34mexpect[39m(markdown)[33m.[39m[34mtoContain[39m([32m'# '[39m)[33m;[39m
    [90m588| [39m    [34mexpect[39m(markdown)[33m.[39m[34mtoContain[39m([32m'Status:'[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m589| [39m    [34mexpect[39m(markdown)[33m.[39m[34mtoContain[39m([32m'Consequences'[39m)[33m;[39m
    [90m590| [39m   }

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[60/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/spec-generator.test.ts[2m > [22mSpecGenerator[2m > [22mvalidateAgainstConstitution[2m > [22mshould check blocker constraints
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/spec-generator.test.ts:[2m730:32[22m[39m
    [90m728| [39m    v[33m.[39m[34mincludes[39m([32m'blocker constraint'[39m)[33m,[39m
    [90m729| [39m   )[33m;[39m
    [90m730| [39m   [34mexpect[39m(hasBlockerViolation)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                               [31m^[39m
    [90m731| [39m  })[33m;[39m
    [90m732| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[61/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/typescript-validator.test.ts[2m > [22mTypeScriptValidator[2m > [22mcontext handling[2m > [22mshould handle specific files
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/typescript-validator.test.ts:[2m512:21[22m[39m
    [90m510| [39m
    [90m511| [39m   [90m// Commands should include specific files[39m
    [90m512| [39m   [34mexpect[39m(mockExec)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m513| [39m  })[33m;[39m
    [90m514| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[62/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/autonomous/__tests__/typescript-validator.test.ts[2m > [22mTypeScriptValidator[2m > [22mcontext handling[2m > [22mshould use working directory
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2mâ¯[22m packages/core/src/autonomous/__tests__/typescript-validator.test.ts:[2m538:21[22m[39m
    [90m536| [39m
    [90m537| [39m   [90m// Commands should use custom working directory[39m
    [90m538| [39m   [34mexpect[39m(mockExec)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                    [31m^[39m
    [90m539| [39m  })[33m;[39m
    [90m540| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[63/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mexecuteParallel[2m > [22mshould execute single task successfully
[31m[1mRangeError[22m: Invalid array length[39m
[36m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m100:13[22m[39m
    [90m 98| [39m   [35mif[39m (executing[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m 99| [39m    [35mconst[39m result [33m=[39m [35mawait[39m [33mPromise[39m[33m.[39m[34mrace[39m(executing)[33m;[39m
    [90m100| [39m    results[33m.[39m[34mpush[39m(result)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m101| [39m
    [90m102| [39m    [90m// Remove completed task from executing list[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m123:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[64/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mexecuteParallel[2m > [22mshould execute multiple tasks sequentially
[31m[1mRangeError[22m: Invalid array length[39m
[36m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m100:13[22m[39m
    [90m 98| [39m   [35mif[39m (executing[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m 99| [39m    [35mconst[39m result [33m=[39m [35mawait[39m [33mPromise[39m[33m.[39m[34mrace[39m(executing)[33m;[39m
    [90m100| [39m    results[33m.[39m[34mpush[39m(result)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m101| [39m
    [90m102| [39m    [90m// Remove completed task from executing list[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m137:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[65/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mexecuteParallel[2m > [22mshould handle task failures gracefully
[31m[1mRangeError[22m: Invalid array length[39m
[36m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m100:13[22m[39m
    [90m 98| [39m   [35mif[39m (executing[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m 99| [39m    [35mconst[39m result [33m=[39m [35mawait[39m [33mPromise[39m[33m.[39m[34mrace[39m(executing)[33m;[39m
    [90m100| [39m    results[33m.[39m[34mpush[39m(result)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m101| [39m
    [90m102| [39m    [90m// Remove completed task from executing list[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m151:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[66/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mexecuteParallel[2m > [22mshould handle mixed success and failure
[31m[1mRangeError[22m: Invalid array length[39m
[36m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m100:13[22m[39m
    [90m 98| [39m   [35mif[39m (executing[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m 99| [39m    [35mconst[39m result [33m=[39m [35mawait[39m [33mPromise[39m[33m.[39m[34mrace[39m(executing)[33m;[39m
    [90m100| [39m    results[33m.[39m[34mpush[39m(result)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m101| [39m
    [90m102| [39m    [90m// Remove completed task from executing list[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m165:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[67/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mexecuteParallel with worktree isolation[2m > [22mshould create and use worktree for task execution
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'catch')[39m
[36m [2mâ¯[22m ParallelExecutor.executeTask packages/core/src/execution/parallel-executor.ts:[2m174:57[22m[39m
    [90m172| [39m   [90m// Remove worktree if created[39m
    [90m173| [39m   [35mif[39m (worktreeId [33m&&[39m [35mthis[39m[33m.[39mworktreeManager) {
    [90m174| [39m    await this.worktreeManager.removeWorktree(worktreeId).catch((err) â€¦
    [90m   | [39m                                                        [31m^[39m
    [90m175| [39m     [90m// Log error but don't fail the task[39m
    [90m176| [39m     [90m// biome-ignore lint/suspicious/noConsole: Error logging[39m
[90m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m99:20[22m[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m195:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[68/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mexecuteParallel with worktree isolation[2m > [22mshould update task with worktree path
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'catch')[39m
[36m [2mâ¯[22m ParallelExecutor.executeTask packages/core/src/execution/parallel-executor.ts:[2m174:57[22m[39m
    [90m172| [39m   [90m// Remove worktree if created[39m
    [90m173| [39m   [35mif[39m (worktreeId [33m&&[39m [35mthis[39m[33m.[39mworktreeManager) {
    [90m174| [39m    await this.worktreeManager.removeWorktree(worktreeId).catch((err) â€¦
    [90m   | [39m                                                        [31m^[39m
    [90m175| [39m     [90m// Log error but don't fail the task[39m
    [90m176| [39m     [90m// biome-ignore lint/suspicious/noConsole: Error logging[39m
[90m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m99:20[22m[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m224:4[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[69/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mexecuteParallel with worktree isolation[2m > [22mshould clean up worktree even if task fails
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'catch')[39m
[36m [2mâ¯[22m ParallelExecutor.executeTask packages/core/src/execution/parallel-executor.ts:[2m174:57[22m[39m
    [90m172| [39m   [90m// Remove worktree if created[39m
    [90m173| [39m   [35mif[39m (worktreeId [33m&&[39m [35mthis[39m[33m.[39mworktreeManager) {
    [90m174| [39m    await this.worktreeManager.removeWorktree(worktreeId).catch((err) â€¦
    [90m   | [39m                                                        [31m^[39m
    [90m175| [39m     [90m// Log error but don't fail the task[39m
    [90m176| [39m     [90m// biome-ignore lint/suspicious/noConsole: Error logging[39m
[90m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m99:20[22m[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m233:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[70/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mexecuteParallel with worktree isolation[2m > [22mshould handle worktree cleanup errors gracefully
[31m[1mRangeError[22m: Invalid array length[39m
[36m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m100:13[22m[39m
    [90m 98| [39m   [35mif[39m (executing[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m 99| [39m    [35mconst[39m result [33m=[39m [35mawait[39m [33mPromise[39m[33m.[39m[34mrace[39m(executing)[33m;[39m
    [90m100| [39m    results[33m.[39m[34mpush[39m(result)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m101| [39m
    [90m102| [39m    [90m// Remove completed task from executing list[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m251:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[71/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mgetActiveExecutions[2m > [22mshould clear active executions after completion
[31m[1mRangeError[22m: Invalid array length[39m
[36m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m100:13[22m[39m
    [90m 98| [39m   [35mif[39m (executing[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m 99| [39m    [35mconst[39m result [33m=[39m [35mawait[39m [33mPromise[39m[33m.[39m[34mrace[39m(executing)[33m;[39m
    [90m100| [39m    results[33m.[39m[34mpush[39m(result)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m101| [39m
    [90m102| [39m    [90m// Remove completed task from executing list[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m272:4[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[72/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mresult aggregation[2m > [22mshould include duration for each task
[31m[1mRangeError[22m: Invalid array length[39m
[36m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m100:13[22m[39m
    [90m 98| [39m   [35mif[39m (executing[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m 99| [39m    [35mconst[39m result [33m=[39m [35mawait[39m [33mPromise[39m[33m.[39m[34mrace[39m(executing)[33m;[39m
    [90m100| [39m    results[33m.[39m[34mpush[39m(result)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m101| [39m
    [90m102| [39m    [90m// Remove completed task from executing list[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m292:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[73/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mresult aggregation[2m > [22mshould include error for failed tasks
[31m[1mRangeError[22m: Invalid array length[39m
[36m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m100:13[22m[39m
    [90m 98| [39m   [35mif[39m (executing[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m 99| [39m    [35mconst[39m result [33m=[39m [35mawait[39m [33mPromise[39m[33m.[39m[34mrace[39m(executing)[33m;[39m
    [90m100| [39m    results[33m.[39m[34mpush[39m(result)[33m;[39m
    [90m   | [39m            [31m^[39m
    [90m101| [39m
    [90m102| [39m    [90m// Remove completed task from executing list[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m302:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[74/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/execution/__tests__/parallel-executor.test.ts[2m > [22mParallelExecutor[2m > [22mresult aggregation[2m > [22mshould include worktree ID when isolation is used
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'catch')[39m
[36m [2mâ¯[22m ParallelExecutor.executeTask packages/core/src/execution/parallel-executor.ts:[2m174:57[22m[39m
    [90m172| [39m   [90m// Remove worktree if created[39m
    [90m173| [39m   [35mif[39m (worktreeId [33m&&[39m [35mthis[39m[33m.[39mworktreeManager) {
    [90m174| [39m    await this.worktreeManager.removeWorktree(worktreeId).catch((err) â€¦
    [90m   | [39m                                                        [31m^[39m
    [90m175| [39m     [90m// Log error but don't fail the task[39m
    [90m176| [39m     [90m// biome-ignore lint/suspicious/noConsole: Error logging[39m
[90m [2mâ¯[22m ParallelExecutor.executeParallel packages/core/src/execution/parallel-executor.ts:[2m99:20[22m[39m
[90m [2mâ¯[22m packages/core/src/execution/__tests__/parallel-executor.test.ts:[2m320:20[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[75/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/parallel/__tests__/cost-aware-load-balancer.test.ts[2m > [22mCostAwareLoadBalancer[2m > [22mrouteTask[2m > [22mshould enforce daily budget limit
[31m[1mAssertionError[22m: promise resolved "{ workerId: 'worker', â€¦(4) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "estimatedCompletionTime": 1000,[39m
[31m+   "estimatedCost": 0.002777777777777778,[39m
[31m+   "reason": "best cost/performance balance, utilization: 50%, score: 0.45",[39m
[31m+   "score": 0.44571428571428573,[39m
[31m+   "workerId": "worker",[39m
[2m  }[22m

[36m [2mâ¯[22m packages/core/src/parallel/__tests__/cost-aware-load-balancer.test.ts:[2m333:45[22m[39m
    [90m331| [39m   budgetBalancer[33m.[39m[34mregisterWorker[39m(profile)[33m;[39m
    [90m332| [39m
    [90m333| [39m   [35mawait[39m [34mexpect[39m(budgetBalancer[33m.[39m[34mrouteTask[39m({}))[33m.[39mrejects[33m.[39m[34mtoThrow[39m(
    [90m   | [39m                                            [31m^[39m
    [90m334| [39m    [32m'Daily budget limit reached'[39m[33m,[39m
    [90m335| [39m   )[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[76/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/parallel/__tests__/merge-coordinator.test.ts[2m > [22mMergeCoordinator[2m > [22mgetMetrics[2m > [22mshould track resolution time
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m packages/core/src/parallel/__tests__/merge-coordinator.test.ts:[2m388:38[22m[39m
    [90m386| [39m
    [90m387| [39m   [35mconst[39m metrics [33m=[39m coordinator[33m.[39m[34mgetMetrics[39m()[33m;[39m
    [90m388| [39m   [34mexpect[39m(metrics[33m.[39mavgResolutionTime)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                     [31m^[39m
    [90m389| [39m  })[33m;[39m
    [90m390| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[77/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/parallel/__tests__/merge-coordinator.test.ts[2m > [22mMergeCoordinator[2m > [22mhigh-risk pattern matching[2m > [22mshould detect .env files
[31m[1mAssertionError[22m: expected false to be true // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

[36m [2mâ¯[22m packages/core/src/parallel/__tests__/merge-coordinator.test.ts:[2m475:37[22m[39m
    [90m473| [39m
    [90m474| [39m   [35mconst[39m strategy [33m=[39m [33mArray[39m[33m.[39m[35mfrom[39m(result[33m.[39mstrategies[33m.[39m[34mvalues[39m())[[34m0[39m][33m;[39m
    [90m475| [39m   [34mexpect[39m(strategy[33m?.[39mrequiresReview)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m476| [39m  })[33m;[39m
    [90m477| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[78/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/parallel/__tests__/work-stealing-scheduler.test.ts[2m > [22mWorkStealingScheduler[2m > [22mwork stealing[2m > [22mshould respect max steal attempts
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m packages/core/src/parallel/__tests__/work-stealing-scheduler.test.ts:[2m332:55[22m[39m
    [90m330| [39m   [35mconst[39m metrics [33m=[39m limitedScheduler[33m.[39m[34mgetMetrics[39m()[33m;[39m
    [90m331| [39m   [90m// Should have attempted stealing[39m
    [90m332| [39m   expect(metrics.failedSteals + metrics.totalSteals).toBeGreaterThan(â€¦
    [90m   | [39m                                                      [31m^[39m
    [90m333| [39m  })[33m;[39m
    [90m334| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[79/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/parallel/__tests__/work-stealing-scheduler.test.ts[2m > [22mWorkStealingScheduler[2m > [22mgetMetrics[2m > [22mshould return scheduler metrics
[31m[1mAssertionError[22m: expected +0 to be 1 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1[39m
[31m+ 0[39m

[36m [2mâ¯[22m packages/core/src/parallel/__tests__/work-stealing-scheduler.test.ts:[2m491:37[22m[39m
    [90m489| [39m   [34mexpect[39m(metrics[33m.[39mavgQueueLength)[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m490| [39m   [34mexpect[39m(metrics[33m.[39mworkerUtilization)[33m.[39m[34mtoBe[39m([34m0[39m)[33m;[39m
    [90m491| [39m   expect(metrics.loadBalanceScore).toBe(1); // Perfect balance when eâ€¦
    [90m   | [39m                                    [31m^[39m
    [90m492| [39m  })[33m;[39m
    [90m493| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[80/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/streaming/__tests__/progress-stream.test.ts[2m > [22mProgressStream[2m > [22msubscribe[2m > [22mshould cleanup subscriber on iterator return
[31m[1mError[22m: Test timed out in 10000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".[39m
[36m [2mâ¯[22m packages/core/src/streaming/__tests__/progress-stream.test.ts:[2m659:3[22m[39m
    [90m657| [39m  })[33m;[39m
    [90m658| [39m
    [90m659| [39m  [34mit[39m([32m'should cleanup subscriber on iterator return'[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m660| [39m   [35mconst[39m subscription [33m=[39m stream[33m.[39m[34msubscribe[39m([32m'task-1'[39m)[33m;[39m
    [90m661| [39m   [35mconst[39m iterator [33m=[39m subscription[[33mSymbol[39m[33m.[39masyncIterator]()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[81/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/core/src/streaming/__tests__/progress-stream.test.ts[2m > [22mProgressStream[2m > [22mclear[2m > [22mshould remove all subscribers
[31m[1mAssertionError[22m: expected +0 to be 2 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 2[39m
[31m+ 0[39m

[36m [2mâ¯[22m packages/core/src/streaming/__tests__/progress-stream.test.ts:[2m1348:29[22m[39m
    [90m1346| [39m
    [90m1347| [39m   [35mconst[39m subscribers [33m=[39m (stream [35mas[39m any)[33m.[39msubscribers[33m;[39m
    [90m1348| [39m   [34mexpect[39m(subscribers[33m.[39msize)[33m.[39m[34mtoBe[39m([34m2[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m1349| [39m
    [90m1350| [39m   stream[33m.[39m[34mclear[39m()[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[82/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/tasks.test.ts[2m > [22mTasks tRPC Router[2m > [22mget[2m > [22mshould throw error when state store is not configured
[31m[1mAssertionError[22m: promise resolved "{ id: 'task-123', â€¦(15) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "checkpoints": [],[39m
[31m+   "completedAt": null,[39m
[31m+   "cost": 0,[39m
[31m+   "createdAt": "2025-12-13T15:58:01.474Z",[39m
[31m+   "currentStep": "Initializing",[39m
[31m+   "error": null,[39m
[31m+   "estimatedRemaining": null,[39m
[31m+   "id": "task-123",[39m
[31m+   "progress": 0,[39m
[31m+   "prompt": "Sample task",[39m
[31m+   "provider": null,[39m
[31m+   "result": null,[39m
[31m+   "startedAt": null,[39m
[31m+   "status": "queued",[39m
[31m+   "subtasks": [],[39m
[31m+   "workerId": null,[39m
[2m  }[22m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/tasks.test.ts:[2m202:39[22m[39m
    [90m200| [39m   [35mconst[39m caller [33m=[39m tasksRouter[33m.[39m[34mcreateCaller[39m(contextWithoutStore)[33m;[39m
    [90m201| [39m
    [90m202| [39m   await expect(caller.get('task-123')).rejects.toThrow('State store nâ€¦
    [90m   | [39m                                      [31m^[39m
    [90m203| [39m  })[33m;[39m
    [90m204| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[83/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/tasks.test.ts[2m > [22mTasks tRPC Router[2m > [22monTaskEvent subscription[2m > [22mshould create subscription for task events
[31m[1mAssertionError[22m: expected 'undefined' to be 'function' // Object.is equality[39m

Expected: [32m"[7mf[27mun[7mction[27m"[39m
Received: [31m"un[7mdefined[27m"[39m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/tasks.test.ts:[2m391:54[22m[39m
    [90m389| [39m
    [90m390| [39m   [34mexpect[39m(subscription)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m391| [39m   [34mexpect[39m([35mtypeof[39m subscription[[33mSymbol[39m[33m.[39masyncIterator])[33m.[39m[34mtoBe[39m([32m'function'[39m)[33m;[39m
    [90m   | [39m                                                     [31m^[39m
    [90m392| [39m  })[33m;[39m
    [90m393| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[84/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/tasks.test.ts[2m > [22mTasks tRPC Router[2m > [22monTaskEvent subscription[2m > [22mshould emit task events
[31m[1mTypeError[22m: subscription is not async iterable[39m
[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/tasks.test.ts:[2m406:31[22m[39m
    [90m404| [39m
    [90m405| [39m   [35mconst[39m collect [33m=[39m ([35masync[39m () [33m=>[39m {
    [90m406| [39m    [35mfor[39m [35mawait[39m ([35mconst[39m event [35mof[39m subscription) {
    [90m   | [39m                              [31m^[39m
    [90m407| [39m     events[33m.[39m[34mpush[39m(event)[33m;[39m
    [90m408| [39m     [35mif[39m (events[33m.[39mlength [33m>=[39m [34m1[39m) [35mbreak[39m[33m;[39m
[90m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/tasks.test.ts:[2m410:4[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[85/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/tasks.test.ts[2m > [22mTasks tRPC Router[2m > [22monTaskEvent subscription[2m > [22mshould emit events with correct structure
[31m[1mTypeError[22m: subscription is not async iterable[39m
[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/tasks.test.ts:[2m432:31[22m[39m
    [90m430| [39m
    [90m431| [39m   [35mconst[39m collect [33m=[39m ([35masync[39m () [33m=>[39m {
    [90m432| [39m    [35mfor[39m [35mawait[39m ([35mconst[39m event [35mof[39m subscription) {
    [90m   | [39m                              [31m^[39m
    [90m433| [39m     events[33m.[39m[34mpush[39m(event)[33m;[39m
    [90m434| [39m     [35mif[39m (events[33m.[39mlength [33m>=[39m [34m1[39m) [35mbreak[39m[33m;[39m
[90m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/tasks.test.ts:[2m436:4[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[86/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22mregister[2m > [22mshould register a worker with metadata
[31m[1mTRPCError[22m: Cannot read properties of undefined (reading '_zod')[39m
[90m [2mâ¯[22m inputValidatorMiddleware node_modules/.pnpm/@trpc+server@11.7.2_typescript@5.9.3/node_modules/@trpc/server/dist/initTRPC-DGaJyg8t.mjs:[2m44:10[22m[39m
[90m [2mâ¯[22m callRecursive node_modules/.pnpm/@trpc+server@11.7.2_typescript@5.9.3/node_modules/@trpc/server/dist/initTRPC-DGaJyg8t.mjs:[2m256:18[22m[39m
[90m [2mâ¯[22m callRecursive node_modules/.pnpm/@trpc+server@11.7.2_typescript@5.9.3/node_modules/@trpc/server/dist/initTRPC-DGaJyg8t.mjs:[2m256:18[22m[39m
[90m [2mâ¯[22m procedure node_modules/.pnpm/@trpc+server@11.7.2_typescript@5.9.3/node_modules/@trpc/server/dist/initTRPC-DGaJyg8t.mjs:[2m281:18[22m[39m
[90m [2mâ¯[22m node_modules/.pnpm/@trpc+server@11.7.2_typescript@5.9.3/node_modules/@trpc/server/dist/tracked-DBSMdVzR.mjs:[2m298:13[22m[39m
[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m98:19[22m[39m
    [90m 96| [39m
    [90m 97| [39m   [35mconst[39m caller [33m=[39m workersRouter[33m.[39m[34mcreateCaller[39m(mockContext)[33m;[39m
    [90m 98| [39m   [35mconst[39m result [33m=[39m [35mawait[39m caller[33m.[39m[34mregister[39m(input)[33m;[39m
    [90m   | [39m                  [31m^[39m
    [90m 99| [39m
    [90m100| [39m   [34mexpect[39m(result[33m.[39msuccess)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m

[31m[1mCaused by: TypeError[22m: Cannot read properties of undefined (reading '_zod')[39m
[90m [2mâ¯[22m Object.inst._zod.parse node_modules/.pnpm/zod@4.1.13/node_modules/zod/v4/core/schemas.js:[2m1270:46[22m[39m
[90m [2mâ¯[22m Object.inst._zod.parse node_modules/.pnpm/zod@4.1.13/node_modules/zod/v4/core/schemas.js:[2m1502:35[22m[39m
[90m [2mâ¯[22m inst._zod.parse node_modules/.pnpm/zod@4.1.13/node_modules/zod/v4/core/schemas.js:[2m815:31[22m[39m
[90m [2mâ¯[22m Object.inst._zod.parse node_modules/.pnpm/zod@4.1.13/node_modules/zod/v4/core/schemas.js:[2m905:16[22m[39m
[90m [2mâ¯[22m Module.<anonymous> node_modules/.pnpm/zod@4.1.13/node_modules/zod/v4/core/parse.js:[2m20:30[22m[39m
[90m [2mâ¯[22m _.inst.parseAsync node_modules/.pnpm/zod@4.1.13/node_modules/zod/v4/classic/schemas.js:[2m29:53[22m[39m
[90m [2mâ¯[22m inputValidatorMiddleware node_modules/.pnpm/@trpc+server@11.7.2_typescript@5.9.3/node_modules/@trpc/server/dist/initTRPC-DGaJyg8t.mjs:[2m42:24[22m[39m
[90m [2mâ¯[22m callRecursive node_modules/.pnpm/@trpc+server@11.7.2_typescript@5.9.3/node_modules/@trpc/server/dist/initTRPC-DGaJyg8t.mjs:[2m256:18[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[87/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22mregister[2m > [22mshould validate workerId is not empty
[31m[1mAssertionError[22m: promise resolved "{ success: true, workerId: '', â€¦(1) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "registeredAt": "2025-12-13T15:58:02.473Z",[39m
[31m+   "success": true,[39m
[31m+   "workerId": "",[39m
[2m  }[22m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m113:39[22m[39m
    [90m111| [39m   [35mconst[39m caller [33m=[39m workersRouter[33m.[39m[34mcreateCaller[39m(mockContext)[33m;[39m
    [90m112| [39m
    [90m113| [39m   [35mawait[39m [34mexpect[39m(caller[33m.[39m[34mregister[39m(input))[33m.[39mrejects[33m.[39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m                                      [31m^[39m
    [90m114| [39m  })[33m;[39m
    [90m115| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[88/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22mheartbeat[2m > [22mshould validate workerId
[31m[1mAssertionError[22m: promise resolved "{ success: true, â€¦(1) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "success": true,[39m
[31m+   "timestamp": "2025-12-13T15:58:02.539Z",[39m
[2m  }[22m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m172:40[22m[39m
    [90m170| [39m   [35mconst[39m caller [33m=[39m workersRouter[33m.[39m[34mcreateCaller[39m(mockContext)[33m;[39m
    [90m171| [39m
    [90m172| [39m   [35mawait[39m [34mexpect[39m(caller[33m.[39m[34mheartbeat[39m(input))[33m.[39mrejects[33m.[39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m                                       [31m^[39m
    [90m173| [39m  })[33m;[39m
    [90m174| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[89/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22mgetStatus[2m > [22mshould validate workerId
[31m[1mAssertionError[22m: promise resolved "{ workerId: '', status: 'idle', â€¦(6) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "capabilities": [],[39m
[31m+   "currentTask": null,[39m
[31m+   "lastHeartbeat": "2025-12-13T15:58:02.718Z",[39m
[31m+   "resources": {[39m
[31m+     "cpu": 0,[39m
[31m+     "memory": 0,[39m
[31m+   },[39m
[31m+   "status": "idle",[39m
[31m+   "totalTasksCompleted": 0,[39m
[31m+   "uptime": 0,[39m
[31m+   "workerId": "",[39m
[2m  }[22m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m265:37[22m[39m
    [90m263| [39m   [35mconst[39m caller [33m=[39m workersRouter[33m.[39m[34mcreateCaller[39m(mockContext)[33m;[39m
    [90m264| [39m
    [90m265| [39m   [35mawait[39m [34mexpect[39m(caller[33m.[39m[34mgetStatus[39m([32m''[39m))[33m.[39mrejects[33m.[39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m                                    [31m^[39m
    [90m266| [39m  })[33m;[39m
    [90m267| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[90/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22massignTask[2m > [22mshould validate workerId and taskId
[31m[1mAssertionError[22m: promise resolved "{ success: true, workerId: '', â€¦(2) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "assignedAt": "2025-12-13T15:58:02.751Z",[39m
[31m+   "success": true,[39m
[31m+   "taskId": "task-123",[39m
[31m+   "workerId": "",[39m
[2m  }[22m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m306:4[22m[39m
    [90m304| [39m   [35mawait[39m [34mexpect[39m(
    [90m305| [39m    caller[33m.[39m[34massignTask[39m({ workerId[33m:[39m [32m''[39m[33m,[39m taskId[33m:[39m [32m'task-123'[39m })[33m,[39m
    [90m306| [39m   )[33m.[39mrejects[33m.[39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m   [31m^[39m
    [90m307| [39m
    [90m308| [39m   [35mawait[39m [34mexpect[39m(

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[91/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22munregister[2m > [22mshould validate workerId
[31m[1mAssertionError[22m: promise resolved "{ success: true, workerId: '', â€¦(1) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "success": true,[39m
[31m+   "unregisteredAt": "2025-12-13T15:58:02.755Z",[39m
[31m+   "workerId": "",[39m
[2m  }[22m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m342:38[22m[39m
    [90m340| [39m   [35mconst[39m caller [33m=[39m workersRouter[33m.[39m[34mcreateCaller[39m(mockContext)[33m;[39m
    [90m341| [39m
    [90m342| [39m   [35mawait[39m [34mexpect[39m(caller[33m.[39m[34munregister[39m([32m''[39m))[33m.[39mrejects[33m.[39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m                                     [31m^[39m
    [90m343| [39m  })[33m;[39m
    [90m344| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[92/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22monWorkerStatus subscription[2m > [22mshould create subscription for worker status
[31m[1mAssertionError[22m: expected 'undefined' to be 'function' // Object.is equality[39m

Expected: [32m"[7mf[27mun[7mction[27m"[39m
Received: [31m"un[7mdefined[27m"[39m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m354:54[22m[39m
    [90m352| [39m
    [90m353| [39m   [34mexpect[39m(subscription)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m354| [39m   [34mexpect[39m([35mtypeof[39m subscription[[33mSymbol[39m[33m.[39masyncIterator])[33m.[39m[34mtoBe[39m([32m'function'[39m)[33m;[39m
    [90m   | [39m                                                     [31m^[39m
    [90m355| [39m  })[33m;[39m
    [90m356| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[93/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22monWorkerStatus subscription[2m > [22mshould emit worker status events
[31m[1mTypeError[22m: subscription is not async iterable[39m
[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m369:31[22m[39m
    [90m367| [39m
    [90m368| [39m   [35mconst[39m collect [33m=[39m ([35masync[39m () [33m=>[39m {
    [90m369| [39m    [35mfor[39m [35mawait[39m ([35mconst[39m event [35mof[39m subscription) {
    [90m   | [39m                              [31m^[39m
    [90m370| [39m     events[33m.[39m[34mpush[39m(event)[33m;[39m
    [90m371| [39m     [35mif[39m (events[33m.[39mlength [33m>=[39m [34m1[39m) [35mbreak[39m[33m;[39m
[90m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m373:4[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[94/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22monWorkerStatus subscription[2m > [22mshould emit events with correct structure
[31m[1mTypeError[22m: subscription is not async iterable[39m
[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m395:31[22m[39m
    [90m393| [39m
    [90m394| [39m   [35mconst[39m collect [33m=[39m ([35masync[39m () [33m=>[39m {
    [90m395| [39m    [35mfor[39m [35mawait[39m ([35mconst[39m event [35mof[39m subscription) {
    [90m   | [39m                              [31m^[39m
    [90m396| [39m     events[33m.[39m[34mpush[39m(event)[33m;[39m
    [90m397| [39m     [35mif[39m (events[33m.[39mlength [33m>=[39m [34m1[39m) [35mbreak[39m[33m;[39m
[90m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m399:4[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[95/96]â¯[22m[39m

[41m[1m FAIL [22m[49m packages/api/src/trpc/routers/__tests__/workers.test.ts[2m > [22mWorkers tRPC Router[2m > [22minput validation[2m > [22mshould validate string fields are not empty
[31m[1mAssertionError[22m: promise resolved "{ success: true, workerId: '', â€¦(1) }" instead of rejecting[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- Error {[39m
[32m-   "message": "rejected promise",[39m
[31m+ {[39m
[31m+   "registeredAt": "2025-12-13T15:58:02.821Z",[39m
[31m+   "success": true,[39m
[31m+   "workerId": "",[39m
[2m  }[22m

[36m [2mâ¯[22m packages/api/src/trpc/routers/__tests__/workers.test.ts:[2m477:4[22m[39m
    [90m475| [39m     resources[33m:[39m { cpu[33m:[39m [34m1[39m[33m,[39m memory[33m:[39m [34m1024[39m }[33m,[39m
    [90m476| [39m    })[33m,[39m
    [90m477| [39m   )[33m.[39mrejects[33m.[39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m   [31m^[39m
    [90m478| [39m  })[33m;[39m
    [90m479| [39m })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[96/96]â¯[22m[39m


[2m Test Files [22m [1m[31m18 failed[39m[22m[2m | [22m[1m[32m64 passed[39m[22m[90m (82)[39m
[2m      Tests [22m [1m[31m94 failed[39m[22m[2m | [22m[1m[32m2237 passed[39m[22m[2m | [22m[33m41 skipped[39m[90m (2372)[39m
[2m   Start at [22m 16:57:58
[2m   Duration [22m 348.92s[2m (transform 8.44s, setup 0ms, import 32.40s, tests 421.01s, environment 17ms)[22m

â€‰ELIFECYCLEâ€‰ Test failed. See above for more details.
